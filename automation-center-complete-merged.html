<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Applied Systems - Automation Center Demo (Complete with Insights)</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
        'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
        sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    * {
      box-sizing: border-box;
    }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // Lucide React Icons as inline SVGs
    const Calendar = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
        <line x1="16" y1="2" x2="16" y2="6"></line>
        <line x1="8" y1="2" x2="8" y2="6"></line>
        <line x1="3" y1="10" x2="21" y2="10"></line>
      </svg>
    );

    const Mail = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
        <polyline points="22,6 12,13 2,6"></polyline>
      </svg>
    );

    const ClipboardList = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
        <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
        <path d="M12 11h4"></path>
        <path d="M12 16h4"></path>
        <path d="M8 11h.01"></path>
        <path d="M8 16h.01"></path>
      </svg>
    );

    const Plus = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
      </svg>
    );

    const Play = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <polygon points="5 3 19 12 5 21 5 3"></polygon>
      </svg>
    );

    const Pause = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <rect x="6" y="4" width="4" height="16"></rect>
        <rect x="14" y="4" width="4" height="16"></rect>
      </svg>
    );

    const MoreVertical = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <circle cx="12" cy="12" r="1"></circle>
        <circle cx="12" cy="5" r="1"></circle>
        <circle cx="12" cy="19" r="1"></circle>
      </svg>
    );

    const ChevronRight = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    );

    const Search = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.35-4.35"></path>
      </svg>
    );

    const Filter = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
      </svg>
    );

    const TrendingUp = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
        <polyline points="17 6 23 6 23 12"></polyline>
      </svg>
    );

    const Check = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>
    );

    const X = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    );

    const Clock = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <circle cx="12" cy="12" r="10"></circle>
        <polyline points="12 6 12 12 16 14"></polyline>
      </svg>
    );

    const Users = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
        <circle cx="9" cy="7" r="4"></circle>
        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
      </svg>
    );

    const Brain = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"></path>
        <path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"></path>
      </svg>
    );

    const Zap = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
      </svg>
    );

    const Activity = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
      </svg>
    );

    const Target = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <circle cx="12" cy="12" r="10"></circle>
        <circle cx="12" cy="12" r="6"></circle>
        <circle cx="12" cy="12" r="2"></circle>
      </svg>
    );

    const AlertTriangle = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <path d="m21.73 18-8-14a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path>
        <line x1="12" y1="9" x2="12" y2="13"></line>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
    );

    // Sample Data
    const sampleAutomations = [
      // INSIGHTS-BASED AUTOMATIONS
      {
        id: 'insights-1',
        name: 'Churn Risk Alert',
        description: 'Detect churn risk by combining activities past expiration and increased quote timeframe',
        status: 'active',
        type: 'insights',
        triggerType: 'composite',
        trigger: {
          type: 'Composite',
          entity: 'Clients',
          condition: 'Churn risk score > 75 (Activities past expiration + Quote timeframe increase)',
          checkFrequency: 'Daily at 7:00 AM',
          icon: 'üéØ'
        },
        lastRun: {
          date: '2 hours ago',
          recordsProcessed: 1892,
          actionsExecuted: 16,
          successRate: 100,
          triggered: true,
          insight: '12 clients at high churn risk (activities overdue + quote delays)'
        },
        actions: ['Alert Account Manager', 'Create Retention Task', 'Generate Risk Report'],
        metrics: {
          totalExecutions: 124,
          triggeredCount: 31,
          accuracy: '87%',
          falsePositives: 4
        }
      },
      {
        id: 'insights-2',
        name: 'Cancellation Spike Detection',
        description: 'Detect unusual increases in policy cancellations',
        status: 'active',
        type: 'insights',
        triggerType: 'anomaly',
        trigger: {
          type: 'Anomaly',
          entity: 'Policies',
          condition: 'Cancellations > 2 std dev from 30-day avg',
          checkFrequency: 'Hourly',
          icon: 'üö®'
        },
        lastRun: {
          date: '45 minutes ago',
          recordsProcessed: 1247,
          actionsExecuted: 6,
          successRate: 100,
          triggered: true,
          insight: 'Detected 45% spike in cancellations'
        },
        actions: ['Send Slack Alert', 'Create Task', 'Generate Report'],
        metrics: {
          totalExecutions: 2156,
          triggeredCount: 12,
          accuracy: '92%',
          falsePositives: 1
        }
      },
      {
        id: 'insights-3',
        name: 'Client Retention Forecast Warning',
        description: 'Alert when predicted client retention rate falls below target',
        status: 'active',
        type: 'insights',
        triggerType: 'predictive',
        trigger: {
          type: 'Predictive',
          entity: 'Clients',
          condition: 'Projected retention rate < 95% of target',
          checkFrequency: 'Daily at 8:00 AM',
          icon: 'üîÆ'
        },
        lastRun: {
          date: '4 hours ago',
          recordsProcessed: 845,
          actionsExecuted: 0,
          successRate: 100,
          triggered: false
        },
        actions: ['Email VP Sales', 'Update Dashboard', 'Schedule Call'],
        metrics: {
          totalExecutions: 89,
          triggeredCount: 7,
          accuracy: '100%',
          falsePositives: 0
        }
      },
      {
        id: 'insights-4',
        name: 'Activities Past Expiration Monitor',
        description: 'Alert when activities past expiration exceed threshold',
        status: 'active',
        type: 'insights',
        triggerType: 'threshold',
        trigger: {
          type: 'Threshold',
          entity: 'Activities',
          condition: 'Activities past expiration > 50',
          checkFrequency: 'Every 6 hours',
          icon: '‚ö†Ô∏è'
        },
        lastRun: {
          date: '1 hour ago',
          recordsProcessed: 15234,
          actionsExecuted: 3,
          successRate: 100,
          triggered: true,
          insight: '62 activities past expiration (12 above threshold)'
        },
        actions: ['Create Tasks', 'Email Report', 'Flag Records'],
        metrics: {
          totalExecutions: 456,
          triggeredCount: 18,
          accuracy: '89%',
          falsePositives: 2
        }
      },
      {
        id: 'insights-5',
        name: 'Renewal Rate Trend Alert',
        description: 'Monitor 7-day rolling renewal rate for declining trends',
        status: 'active',
        type: 'insights',
        triggerType: 'trend',
        trigger: {
          type: 'Trend',
          entity: 'Policies',
          condition: 'Renewal rate declining > 5% over 7 days',
          checkFrequency: 'Daily at 10:00 AM',
          icon: 'üìà'
        },
        lastRun: {
          date: '3 hours ago',
          recordsProcessed: 3421,
          actionsExecuted: 4,
          successRate: 100,
          triggered: true,
          insight: 'Renewal rate down 6.2% this week'
        },
        actions: ['Email Sales Leadership', 'Create Report', 'Schedule Meeting'],
        metrics: {
          totalExecutions: 87,
          triggeredCount: 9,
          accuracy: '89%',
          falsePositives: 1
        }
      },
      {
        id: 'insights-6',
        name: 'Office Performance Variance',
        description: 'Alert when offices deviate significantly from regional average',
        status: 'active',
        type: 'insights',
        triggerType: 'comparative',
        trigger: {
          type: 'Comparative',
          entity: 'Offices',
          condition: 'Office performance < -15% vs regional avg',
          checkFrequency: 'Weekly on Fridays',
          icon: 'üèÜ'
        },
        lastRun: {
          date: '2 days ago',
          recordsProcessed: 47,
          actionsExecuted: 6,
          successRate: 100,
          triggered: true,
          insight: '3 offices underperforming'
        },
        actions: ['Email Directors', 'Create Coaching Plan', 'Schedule Review'],
        metrics: {
          totalExecutions: 48,
          triggeredCount: 12,
          accuracy: '83%',
          falsePositives: 2
        }
      },
      {
        id: 'insights-7',
        name: 'Duplicate Entry Detection',
        description: 'Identify potential duplicate records being created',
        status: 'active',
        type: 'insights',
        triggerType: 'pattern',
        trigger: {
          type: 'Pattern',
          entity: 'All Entities',
          condition: 'Potential duplicates > 10 per hour',
          checkFrequency: 'Hourly',
          icon: 'üîç'
        },
        lastRun: {
          date: '20 minutes ago',
          recordsProcessed: 892,
          actionsExecuted: 0,
          successRate: 100,
          triggered: false
        },
        actions: ['Flag Duplicates', 'Create Review Queue', 'Send Summary'],
        metrics: {
          totalExecutions: 2156,
          triggeredCount: 45,
          accuracy: '82%',
          falsePositives: 8
        }
      },
      // STANDARD AUTOMATIONS
      {
        id: '1',
        name: '60-Day Renewal Reminder',
        description: 'Send renewal reminders for policies expiring in 60 days',
        status: 'active',
        type: 'standard',
        trigger: {
          entity: 'Policies',
          schedule: 'Daily at 9:00 AM'
        },
        lastRun: {
          date: '2 hours ago',
          recordsProcessed: 247,
          actionsExecuted: 312,
          successRate: 98
        },
        actions: ['Send Campaign', 'Create Activity']
      },
      {
        id: '2',
        name: 'High-Value Client Review',
        description: 'Schedule reviews for clients with premium > $10K',
        status: 'active',
        type: 'standard',
        trigger: {
          entity: 'Clients',
          schedule: 'Monthly on 1st'
        },
        lastRun: {
          date: '3 days ago',
          recordsProcessed: 89,
          actionsExecuted: 178,
          successRate: 100
        },
        actions: ['Send Campaign', 'Create Activity']
      },
      {
        id: '3',
        name: 'Quote Follow-Up',
        description: 'Follow up on quotes older than 3 days',
        status: 'active',
        type: 'standard',
        trigger: {
          entity: 'Quotes',
          schedule: 'Daily at 10:00 AM'
        },
        lastRun: {
          date: '1 hour ago',
          recordsProcessed: 42,
          actionsExecuted: 84,
          successRate: 95
        },
        actions: ['Send Campaign', 'Create Activity']
      },
      {
        id: '4',
        name: 'New Client Onboarding',
        description: 'Welcome sequence for new clients',
        status: 'paused',
        type: 'standard',
        trigger: {
          entity: 'Policies',
          schedule: 'Daily at 8:00 AM'
        },
        actions: ['Send Campaign Series', 'Create Checklist']
      }
    ];

    const templates = [
      // INSIGHTS-BASED TEMPLATES
      {
        id: 'insights-1',
        name: 'Anomaly Detection Alert',
        description: 'Detect unusual spikes or drops in key metrics using statistical analysis',
        category: 'Insights & Analytics',
        icon: 'üö®',
        popularity: 15,
        isAdvanced: true,
        isInsights: true,
        triggerType: 'anomaly',
        usesLooker: true
      },
      {
        id: 'insights-2',
        name: 'Predictive Performance Alert',
        description: 'Forecast future trends and alert before targets are missed',
        category: 'Insights & Analytics',
        icon: 'üîÆ',
        popularity: 22,
        isAdvanced: true,
        isInsights: true,
        triggerType: 'predictive',
        usesLooker: true
      },
      {
        id: 'insights-3',
        name: 'Threshold Breach Monitor',
        description: 'Alert when key metrics cross defined thresholds',
        category: 'Insights & Analytics',
        icon: '‚ö†Ô∏è',
        popularity: 38,
        isAdvanced: false,
        isInsights: true,
        triggerType: 'threshold',
        usesLooker: true
      },
      {
        id: 'insights-4',
        name: 'Trend Analysis Alert',
        description: 'Monitor trends over time and alert on concerning patterns',
        category: 'Insights & Analytics',
        icon: 'üìà',
        popularity: 28,
        isAdvanced: true,
        isInsights: true,
        triggerType: 'trend',
        usesLooker: true
      },
      {
        id: 'insights-5',
        name: 'Pattern Recognition Alert',
        description: 'Detect recurring patterns or unexpected behaviors in data',
        category: 'Insights & Analytics',
        icon: 'üîç',
        popularity: 12,
        isAdvanced: true,
        isInsights: true,
        triggerType: 'pattern',
        usesLooker: true
      },
      {
        id: 'insights-6',
        name: 'Comparative Performance Monitor',
        description: 'Compare performance across regions, teams, or time periods',
        category: 'Insights & Analytics',
        icon: 'üèÜ',
        popularity: 19,
        isAdvanced: true,
        isInsights: true,
        triggerType: 'comparative',
        usesLooker: true
      },
      {
        id: 'insights-7',
        name: 'Multi-Factor Risk Alert',
        description: 'Combine multiple conditions for sophisticated risk detection (e.g., Activities + Quote timeframe = Churn risk)',
        category: 'Risk Management',
        icon: 'üéØ',
        popularity: 16,
        isAdvanced: true,
        isInsights: true,
        triggerType: 'composite',
        usesLooker: true
      },
      {
        id: 'insights-8',
        name: 'Data Quality Monitor',
        description: 'Track data completeness, accuracy, and consistency',
        category: 'Data Quality',
        icon: '‚úÖ',
        popularity: 31,
        isAdvanced: false,
        isInsights: true,
        triggerType: 'threshold',
        usesLooker: true
      },
      // STANDARD TEMPLATES
      {
        id: 't1',
        name: '60-Day Renewal Reminder',
        description: 'Automatically remind clients about upcoming policy renewals',
        category: 'Policy Lifecycle',
        icon: 'üîÑ',
        popularity: 95,
        isAdvanced: false,
        usesLooker: false
      },
      {
        id: 't2',
        name: 'High-Value Client Review',
        description: 'Schedule periodic reviews for your most valuable clients',
        category: 'Client Engagement',
        icon: '‚≠ê',
        popularity: 88,
        isAdvanced: false,
        usesLooker: true,
        lookerLookId: 'look_2'
      },
      {
        id: 't3',
        name: 'Quote Follow-Up',
        description: 'Never miss following up on outstanding quotes',
        category: 'Sales Process',
        icon: 'üìã',
        popularity: 92,
        isAdvanced: false,
        usesLooker: true,
        lookerLookId: 'look_3'
      },
      {
        id: 't4',
        name: 'New Client Onboarding',
        description: 'Welcome new clients with automated onboarding sequence',
        category: 'Client Engagement',
        icon: 'üëã',
        popularity: 85,
        isAdvanced: false,
        usesLooker: true,
        lookerLookId: 'look_7'
      },
      {
        id: 't5',
        name: 'Cross-Sell Opportunity',
        description: 'Identify and act on cross-sell opportunities',
        category: 'Sales Process',
        icon: 'üéØ',
        popularity: 78,
        isAdvanced: false,
        usesLooker: true,
        lookerLookId: 'look_5'
      },
      {
        id: 't6',
        name: 'Policy Lapse Prevention',
        description: 'Prevent policy cancellations with proactive outreach',
        category: 'Policy Lifecycle',
        icon: 'üõ°Ô∏è',
        popularity: 90,
        isAdvanced: false,
        usesLooker: true,
        lookerLookId: 'look_6'
      },
      {
        id: 't7',
        name: 'Automated Quote-to-Bind Workflow',
        description: 'Complete workflow: Create submission ‚Üí Generate quotes ‚Üí Build proposal ‚Üí Send to client',
        category: 'Advanced Workflows',
        icon: '‚ö°',
        popularity: 87,
        isAdvanced: true,
        usesLooker: false
      },
      {
        id: 't8',
        name: 'Renewal Quote Pipeline',
        description: 'Auto-generate renewal submissions, get multiple quotes, and create comparison proposals',
        category: 'Advanced Workflows',
        icon: 'üîÑ',
        popularity: 92,
        isAdvanced: true,
        usesLooker: true,
        lookerLookId: 'look_4'
      },
      {
        id: 't9',
        name: 'Lead to Bound Policy',
        description: 'End-to-end: Create submission ‚Üí Quote ‚Üí Proposal ‚Üí Activity reminders ‚Üí Bind notification',
        category: 'Advanced Workflows',
        icon: 'üéØ',
        popularity: 85,
        isAdvanced: true,
        usesLooker: false
      },
      {
        id: 't10',
        name: 'Comparative Quote Workflow',
        description: 'Request quotes from 3+ carriers, wait for responses, build comparison, notify producer',
        category: 'Advanced Workflows',
        icon: 'üìä',
        popularity: 79,
        isAdvanced: true,
        usesLooker: false
      },
      {
        id: 't11',
        name: 'Commercial Workers Comp Outreach',
        description: 'Looker-powered: Identify commercial clients without workers comp and launch targeted campaign',
        category: 'Looker-Powered',
        icon: 'üìä',
        popularity: 84,
        isAdvanced: false,
        usesLooker: true,
        lookerLookId: 'look_8'
      },
      {
        id: 't12',
        name: 'At-Risk Policy Recovery',
        description: 'Looker-powered: Automated intervention for policies at risk of lapsing',
        category: 'Looker-Powered',
        icon: 'üö®',
        popularity: 91,
        isAdvanced: false,
        usesLooker: true,
        lookerLookId: 'look_6'
      }
    ];

    // Main Component
    function AutomationCenterDemo() {
      const [currentArea, setCurrentArea] = useState('home'); // 'home', 'data-management', or 'data-migrations'
      const [currentView, setCurrentView] = useState('dashboard');
      const [selectedTemplate, setSelectedTemplate] = useState(null);
      const [selectedAutomation, setSelectedAutomation] = useState(null);
      const [selectedTriggerType, setSelectedTriggerType] = useState(null);

      // New state for operations and mappings
      const operationsInProgress = [
        { id: 'op1', name: 'Policy Import #1234', progress: 60, total: 500, current: 300 }
      ];
      const incompleteMappings = 2;

      return (
        <div className="min-h-screen bg-gray-50">
          {/* Header */}
          <header className="bg-white border-b border-gray-200">
            <div className="max-w-7xl mx-auto px-6">
              <div className="flex items-center justify-between py-4">
                <div className="flex items-center gap-6">
                  <div>
                    <h1 className="text-2xl font-bold text-gray-900">Data Management Center</h1>
                    <p className="text-sm text-gray-600 mt-1">
                      {currentArea === 'home'
                        ? 'Overview of data driven workflows and data quality'
                        : currentArea === 'data-management'
                          ? 'Automate workflows, manage operations, and maintain data quality'
                          : 'Manage code mappings, imports, and data migrations'}
                    </p>
                  </div>

                  {/* Top-Level Navigation */}
                  {currentView !== 'builder' && currentView !== 'view' && (
                    <div className="flex gap-1 ml-6">
                      <button
                        onClick={() => {
                          setCurrentArea('home');
                          setCurrentView('dashboard');
                        }}
                        className={`px-4 py-2 font-semibold transition-colors border-b-2 ${currentArea === 'home'
                          ? 'border-blue-600 text-blue-600'
                          : 'border-transparent text-gray-600 hover:text-gray-900'
                          }`}
                      >
                        Home
                      </button>
                      <button
                        onClick={() => {
                          setCurrentArea('data-management');
                          if (currentView === 'import' || currentView === 'mapping') {
                            setCurrentView('automations');
                          } else if (currentView === 'dashboard') {
                            setCurrentView('automations');
                          }
                        }}
                        className={`px-4 py-2 font-semibold transition-colors border-b-2 ${currentArea === 'data-management'
                          ? 'border-blue-600 text-blue-600'
                          : 'border-transparent text-gray-600 hover:text-gray-900'
                          }`}
                      >
                        Data Workflows
                      </button>
                      <button
                        onClick={() => {
                          setCurrentArea('data-migrations');
                          if (currentView === 'import' || currentView === 'mapping') {
                            // Stay in current view if it's migration-related
                          } else {
                            setCurrentView('mappings');
                          }
                        }}
                        className={`px-4 py-2 font-semibold transition-colors border-b-2 ${currentArea === 'data-migrations'
                          ? 'border-blue-600 text-blue-600'
                          : 'border-transparent text-gray-600 hover:text-gray-900'
                          }`}
                      >
                        Data Migrations
                      </button>
                    </div>
                  )}
                </div>

                <div className="flex gap-3">
                  {currentArea === 'data-migrations' && (
                    <button
                      onClick={() => setCurrentView('import')}
                      className="bg-purple-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-purple-700 transition-colors"
                    >
                      <Plus size={20} />
                      New Import
                    </button>
                  )}
                  {(currentArea === 'home' || currentArea === 'data-management') && (
                    <button
                      onClick={() => setCurrentView('trigger-select')}
                      className="bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-700 transition-colors"
                    >
                      <Plus size={20} />
                      New Workflow
                    </button>
                  )}
                </div>
              </div>
            </div>
          </header>

          {/* Navigation Tabs */}
          {currentView !== 'builder' && currentView !== 'view' && currentView !== 'import' && currentView !== 'mapping' && currentArea !== 'home' && (
            <div className="bg-white border-b border-gray-200">
              <div className="max-w-7xl mx-auto px-6">
                <nav className="flex gap-6">
                  {currentArea === 'data-management' ? (
                    <>
                      <button
                        onClick={() => setCurrentView('automations')}
                        className={`py-4 border-b-2 font-medium transition-colors flex items-center gap-2 ${currentView === 'automations'
                          ? 'border-blue-600 text-blue-600'
                          : 'border-transparent text-gray-600 hover:text-gray-900'
                          }`}
                      >
                        <Play size={18} />
                        Workflows
                      </button>

                      <button
                        onClick={() => setCurrentView('quality')}
                        className={`py-4 border-b-2 font-medium transition-colors flex items-center gap-2 ${currentView === 'quality'
                          ? 'border-blue-600 text-blue-600'
                          : 'border-transparent text-gray-600 hover:text-gray-900'
                          }`}
                      >
                        <Check size={18} />
                        Data Quality
                      </button>
                      <button
                        onClick={() => setCurrentView('templates')}
                        className={`py-4 border-b-2 font-medium transition-colors flex items-center gap-2 ${currentView === 'templates'
                          ? 'border-blue-600 text-blue-600'
                          : 'border-transparent text-gray-600 hover:text-gray-900'
                          }`}
                      >
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                          <polyline points="14 2 14 8 20 8"></polyline>
                          <line x1="16" y1="13" x2="8" y2="13"></line>
                          <line x1="16" y1="17" x2="8" y2="17"></line>
                          <polyline points="10 9 9 9 8 9"></polyline>
                        </svg>
                        Templates
                      </button>
                      <button
                        onClick={() => setCurrentView('data-lake')}
                        className={`py-4 border-b-2 font-medium transition-colors flex items-center gap-2 ${currentView === 'data-lake'
                          ? 'border-blue-600 text-blue-600'
                          : 'border-transparent text-gray-600 hover:text-gray-900'
                          }`}
                      >
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                          <ellipse cx="12" cy="5" rx="9" ry="3"></ellipse>
                          <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path>
                          <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path>
                        </svg>
                        Data Lake
                      </button>
                    </>
                  ) : (
                    <>
                      <button
                        onClick={() => setCurrentView('mappings')}
                        className={`py-4 border-b-2 font-medium transition-colors flex items-center gap-2 ${currentView === 'mappings'
                          ? 'border-blue-600 text-blue-600'
                          : 'border-transparent text-gray-600 hover:text-gray-900'
                          }`}
                      >
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                          <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                          <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                          <line x1="12" y1="22.08" x2="12" y2="12"></line>
                        </svg>
                        Code Mappings
                        {incompleteMappings > 0 && (
                          <span className="ml-1 px-2 py-0.5 bg-yellow-100 text-yellow-800 text-xs font-bold rounded-full">
                            {incompleteMappings}
                          </span>
                        )}
                      </button>
                      <button
                        onClick={() => setCurrentView('operations')}
                        className={`py-4 border-b-2 font-medium transition-colors flex items-center gap-2 ${currentView === 'operations'
                          ? 'border-blue-600 text-blue-600'
                          : 'border-transparent text-gray-600 hover:text-gray-900'
                          }`}
                      >
                        <ClipboardList size={18} />
                        Import Operations
                        {operationsInProgress.length > 0 && (
                          <span className="ml-1 px-2 py-0.5 bg-orange-100 text-orange-800 text-xs font-bold rounded-full">
                            {operationsInProgress.length}
                          </span>
                        )}
                      </button>
                    </>
                  )}
                </nav>
              </div>
            </div>
          )}

          {/* Main Content */}
          <main className="max-w-7xl mx-auto px-6 py-8">
            {currentView === 'dashboard' && (
              <DashboardView
                onViewAutomation={(automation) => {
                  setSelectedAutomation(automation);
                  setCurrentView('view');
                }}
              />
            )}
            {currentView === 'automations' && (
              <AutomationsListView
                onViewAutomation={(automation) => {
                  setSelectedAutomation(automation);
                  setCurrentView('view');
                }}
              />
            )}
            {currentView === 'operations' && <ManualOperationsView />}
            {currentView === 'mappings' && <CodeMappingsView onEditMapping={() => setCurrentView('mapping')} />}
            {currentView === 'mapping' && <CodeMappingEditor onBack={() => setCurrentView('mappings')} />}
            {currentView === 'quality' && <DataQualityView />}
            {currentView === 'trigger-select' && (
              <TriggerTypeSelector
                onSelectTriggerType={(triggerType) => {
                  if (triggerType.category === 'natural-language') {
                    setCurrentView('natural-language');
                  } else {
                    setSelectedTriggerType(triggerType);
                    // Create a template object based on trigger type
                    const template = {
                      id: `custom-${triggerType.id}`,
                      name: `New ${triggerType.name}`,
                      isInsights: triggerType.category === 'insights',
                      triggerType: triggerType.id,
                      ...triggerType
                    };
                    setSelectedTemplate(template);
                    setCurrentView('builder');
                  }
                }}
              />
            )}
            {currentView === 'natural-language' && (
              <NaturalLanguageBuilder
                onBack={() => setCurrentView('trigger-select')}
                onComplete={(automationData) => {
                  setSelectedTemplate(automationData);
                  setCurrentView('builder');
                }}
              />
            )}
            {currentView === 'templates' && (
              <TemplatesView
                onSelectTemplate={(template) => {
                  if (template.isNaturalLanguage) {
                    setCurrentView('natural-language');
                  } else {
                    setSelectedTemplate(template);
                    setCurrentView('builder');
                  }
                }}
              />
            )}
            {currentView === 'data-lake' && <DataLakeView />}
            {currentView === 'import' && <ImportWizard onBack={() => setCurrentView('operations')} />}
            {currentView === 'builder' && (
              <BuilderView
                template={selectedTemplate}
                triggerType={selectedTriggerType}
                onBack={() => setCurrentView('dashboard')}
              />
            )}
            {currentView === 'view' && (
              <AutomationViewPage
                automation={selectedAutomation}
                onBack={() => setCurrentView('dashboard')}
                onEdit={() => {
                  setSelectedTemplate(selectedAutomation);
                  setCurrentView('builder');
                }}
              />
            )}
          </main>
        </div>
      );
    }

    // Automations List View - Dedicated page for automations
    function AutomationsListView({ onViewAutomation }) {
      return (
        <div className="space-y-6">
          <div>
            <h1 className="text-2xl font-bold text-gray-900 mb-2">Workflows</h1>
            <p className="text-gray-600">Manage your scheduled and automated workflows</p>
          </div>
          <ActiveAutomationsTabContent onViewAutomation={onViewAutomation} />
        </div>
      );
    }

    // Manual Operations View
    function ManualOperationsView() {
      const [activeTab, setActiveTab] = useState('active'); // 'active' or 'history'

      const activeOperations = [
        {
          id: 'op1',
          type: 'Policy Import',
          name: 'ABC Insurance - Policy Import #1234',
          progress: 60,
          current: 300,
          total: 500,
          startedBy: 'John Smith',
          startedAt: '10 minutes ago',
          status: 'running'
        }
      ];

      const recentOperations = [
        { id: 'op2', type: 'Client Import', name: 'Client Import #1233', records: 250, status: 'completed', completedAt: '2 hours ago', user: 'Sarah Johnson' },
        { id: 'op3', type: 'Code Mapping', name: 'Branch Code Update', records: 45, status: 'completed', completedAt: 'Yesterday', user: 'Mike Wilson' },
        { id: 'op4', type: 'Quote Import', name: 'Quote Import #1231', records: 88, status: 'failed', completedAt: '2 days ago', user: 'John Smith', errorCount: 12 },
        { id: 'op5', type: 'Bulk Update', name: 'Update Producer Codes', records: 156, status: 'completed', completedAt: '3 days ago', user: 'Sarah Johnson' },
      ];

      return (
        <div className="space-y-6">
          <div className="flex items-center justify-between">
            <div>
              <h1 className="text-2xl font-bold text-gray-900 mb-2">Manual Operations</h1>
              <p className="text-gray-600">Run workflows on-demand and manage data imports</p>
            </div>
            <div className="flex gap-3">
              <button className="px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 flex items-center gap-2">
                <Plus size={20} />
                New Import
              </button>
              <button className="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 flex items-center gap-2">
                <Play size={20} />
                Run Workflow
              </button>
              <button className="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50">
                Bulk Update
              </button>
            </div>
          </div>

          {/* Active Operations */}
          {activeOperations.length > 0 && (
            <div className="bg-white rounded-lg border border-gray-200 p-6">
              <h2 className="text-lg font-bold text-gray-900 mb-4 flex items-center gap-2">
                <span className="inline-block w-2 h-2 bg-orange-500 rounded-full animate-pulse"></span>
                Active Operations ({activeOperations.length})
              </h2>
              <div className="space-y-4">
                {activeOperations.map(op => (
                  <div key={op.id} className="border border-gray-200 rounded-lg p-4">
                    <div className="flex items-start justify-between mb-3">
                      <div>
                        <div className="font-bold text-gray-900 mb-1">{op.name}</div>
                        <div className="text-sm text-gray-600">
                          Started: {op.startedAt} by {op.startedBy}
                        </div>
                      </div>
                      <button className="px-3 py-1 border border-red-300 text-red-600 rounded-lg text-sm font-medium hover:bg-red-50">
                        Cancel
                      </button>
                    </div>
                    <div className="relative">
                      <div className="flex items-center justify-between text-sm mb-2">
                        <span className="text-gray-600">Progress: {op.current}/{op.total} records</span>
                        <span className="font-medium text-gray-900">{op.progress}%</span>
                      </div>
                      <div className="w-full bg-gray-200 rounded-full h-3">
                        <div
                          className="bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full transition-all duration-300"
                          style={{ width: `${op.progress}%` }}
                        ></div>
                      </div>
                    </div>
                    <div className="mt-3 flex gap-2">
                      <button className="text-sm text-blue-600 hover:text-blue-700 font-medium">
                        View Details ‚Üí
                      </button>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}

          {/* Tabs for Active/History */}
          <div className="bg-white rounded-lg border border-gray-200">
            <div className="border-b border-gray-200">
              <nav className="flex px-6">
                <button
                  onClick={() => setActiveTab('history')}
                  className={`py-4 px-4 border-b-2 font-medium transition-colors ${activeTab === 'history'
                    ? 'border-blue-600 text-blue-600'
                    : 'border-transparent text-gray-600 hover:text-gray-900'
                    }`}
                >
                  Recent Operations
                </button>
              </nav>
            </div>

            <div className="p-6">
              <div className="space-y-3">
                {recentOperations.map(op => (
                  <div key={op.id} className="flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:shadow-sm transition-shadow">
                    <div className="flex items-center gap-4 flex-1">
                      <div className={`w-10 h-10 rounded-lg flex items-center justify-center ${op.status === 'completed' ? 'bg-green-100' : 'bg-red-100'
                        }`}>
                        {op.status === 'completed' ?
                          <Check className="text-green-600" size={20} /> :
                          <X className="text-red-600" size={20} />
                        }
                      </div>
                      <div className="flex-1">
                        <div className="font-medium text-gray-900">{op.name}</div>
                        <div className="text-sm text-gray-600">
                          {op.records} records ‚Ä¢ {op.completedAt} ‚Ä¢ by {op.user}
                          {op.errorCount && (
                            <span className="ml-2 text-red-600">‚Ä¢ {op.errorCount} errors</span>
                          )}
                        </div>
                      </div>
                    </div>
                    <div className="flex gap-2">
                      <button className="px-3 py-1 text-sm text-blue-600 hover:text-blue-700 font-medium">
                        View Details
                      </button>
                      {op.status === 'failed' && (
                        <button className="px-3 py-1 border border-blue-300 text-blue-600 rounded-lg text-sm font-medium hover:bg-blue-50">
                          Retry
                        </button>
                      )}
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    }

    // Dashboard View
    function DashboardView({ onViewAutomation }) {
      const [dashboardTab, setDashboardTab] = useState('schedule'); // 'schedule' or 'active'
      const [timelineView, setTimelineView] = useState('week'); // 'week' or 'month'

      const notifications = [
        {
          id: 'n1',
          type: 'action_required',
          title: 'Code Mapping Incomplete',
          message: 'Policy Import #1234 has 8 unmapped producer codes',
          time: '2 hours ago',
          actions: [{ label: 'Review & Map', primary: true }]
        },
        {
          id: 'n2',
          type: 'running',
          title: 'Import in Progress',
          message: 'Policy Import #1234 - 300/500 records processed (60%)',
          time: '10 minutes ago',
          actions: [{ label: 'View Details', primary: false }]
        }
      ];

      return (
        <div className="space-y-6">
          {/* Notifications Widget */}
          {notifications.length > 0 && (
            <div className="bg-white rounded-lg border border-orange-200 p-4">
              <div className="flex items-center justify-between mb-3">
                <h3 className="font-bold text-gray-900 flex items-center gap-2">
                  <span className="text-orange-600">üîî</span>
                  Action Required ({notifications.filter(n => n.type === 'action_required').length})
                </h3>
                <button className="text-sm text-blue-600 hover:text-blue-700">View All</button>
              </div>
              <div className="space-y-2">
                {notifications.map(notif => (
                  <div key={notif.id} className={`p-3 rounded-lg border ${notif.type === 'action_required' ? 'bg-orange-50 border-orange-200' : 'bg-blue-50 border-blue-200'
                    }`}>
                    <div className="flex items-start justify-between">
                      <div className="flex-1">
                        <div className="font-medium text-gray-900 text-sm">{notif.title}</div>
                        <div className="text-xs text-gray-600 mt-1">{notif.message}</div>
                        <div className="text-xs text-gray-500 mt-1">{notif.time}</div>
                      </div>
                      <div className="flex gap-2 ml-4">
                        {notif.actions.map((action, idx) => (
                          <button
                            key={idx}
                            className={`px-3 py-1 rounded text-xs font-medium ${action.primary
                              ? 'bg-blue-600 text-white hover:bg-blue-700'
                              : 'border border-gray-300 text-gray-700 hover:bg-gray-50'
                              }`}
                          >
                            {action.label}
                          </button>
                        ))}
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}

          {/* Enhanced Performance Summary - Business Metrics */}
          <div>
            <h2 className="text-lg font-bold text-gray-900 mb-4">Performance Overview</h2>
            <div className="grid grid-cols-1 md:grid-cols-6 gap-4">
              <MetricCard
                title="Data Quality"
                value="94.2%"
                subtitle="Overall health score"
                icon={<Check className="text-green-600" size={24} />}
                trend="+2.3%"
                trendLabel="vs last month"
              />
              <MetricCard
                title="Renewal Rate"
                value="94.2%"
                subtitle="Policies renewed"
                icon={<TrendingUp className="text-green-600" size={24} />}
                trend="+3.2%"
                trendLabel="vs last month"
              />
              <MetricCard
                title="Response Rate"
                value="31.4%"
                subtitle="Campaign engagement"
                icon={<Mail className="text-blue-600" size={24} />}
                trend="+5.1%"
                trendLabel="vs last month"
              />
              <MetricCard
                title="Quote Conversion"
                value="42.8%"
                subtitle="Quotes to policies"
                icon={<Check className="text-emerald-600" size={24} />}
                trend="+2.3%"
                trendLabel="vs last month"
              />
              <MetricCard
                title="Time Saved"
                value="127 hrs"
                subtitle="Manual work automated"
                icon={<Clock className="text-purple-600" size={24} />}
                trend="+18 hrs"
                trendLabel="vs last month"
              />
              <MetricCard
                title="Success Rate"
                value="97.8%"
                subtitle="Executions completed"
                icon={<Check className="text-teal-600" size={24} />}
                trend="+1.2%"
                trendLabel="vs last month"
              />
            </div>
          </div>



          {/* Main Content with Tabs */}
          <div className="bg-white rounded-lg border border-gray-200">
            {/* Tab Headers */}
            <div className="border-b border-gray-200">
              <nav className="flex px-6">
                <button
                  onClick={() => setDashboardTab('schedule')}
                  className={`py-4 px-4 border-b-2 font-medium transition-colors flex items-center gap-2 ${dashboardTab === 'schedule'
                    ? 'border-blue-600 text-blue-600'
                    : 'border-transparent text-gray-600 hover:text-gray-900'
                    }`}
                >
                  <Calendar size={20} />
                  Schedule
                  <span className="ml-2 px-2 py-0.5 bg-blue-100 text-blue-800 text-xs font-bold rounded-full">
                    47
                  </span>
                </button>
                <button
                  onClick={() => setDashboardTab('active')}
                  className={`py-4 px-4 border-b-2 font-medium transition-colors flex items-center gap-2 ${dashboardTab === 'active'
                    ? 'border-blue-600 text-blue-600'
                    : 'border-transparent text-gray-600 hover:text-gray-900'
                    }`}
                >
                  <Play size={20} />
                  Active Automations
                  <span className="ml-2 px-2 py-0.5 bg-green-100 text-green-800 text-xs font-bold rounded-full">
                    {sampleAutomations.filter(a => a.status === 'active').length}
                  </span>
                </button>
              </nav>
            </div>

            {/* Tab Content */}
            <div className="p-6">
              {dashboardTab === 'schedule' && (
                <ScheduleTabContent
                  timelineView={timelineView}
                  setTimelineView={setTimelineView}
                />
              )}
              {dashboardTab === 'active' && (
                <ActiveAutomationsTabContent
                  onViewAutomation={onViewAutomation}
                />
              )}
            </div>
          </div>
        </div>
      );
    }

    // Code Mappings View
    function CodeMappingsView({ onEditMapping }) {
      const mappingTables = [
        { id: '1', name: 'Branch Codes', mappings: 45, status: 'complete', lastUpdated: '2 days ago', unmapped: 0 },
        { id: '2', name: 'Producer Codes', mappings: 123, status: 'incomplete', lastUpdated: '1 week ago', unmapped: 8 },
        { id: '3', name: 'Carrier Codes', mappings: 67, status: 'complete', lastUpdated: '3 days ago', unmapped: 0 },
        { id: '4', name: 'Line of Business Codes', mappings: 34, status: 'complete', lastUpdated: '1 week ago', unmapped: 0 },
        { id: '5', name: 'Coverage Codes', mappings: 89, status: 'incomplete', lastUpdated: '4 days ago', unmapped: 3 },
      ];

      return (
        <div className="space-y-6">
          <div className="flex items-center justify-between">
            <div>
              <h1 className="text-2xl font-bold text-gray-900 mb-2">Code Mappings</h1>
              <p className="text-gray-600">Manage code translations for data imports and migrations</p>
            </div>
            <div className="flex gap-3">
              <button className="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50">
                Import Mappings
              </button>
              <button className="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 flex items-center gap-2">
                <Plus size={20} />
                New Mapping Table
              </button>
            </div>
          </div>

          {/* Alert for incomplete mappings */}
          {mappingTables.some(m => m.status === 'incomplete') && (
            <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
              <div className="flex items-start gap-3">
                <svg className="text-yellow-600 mt-0.5" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                  <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                  <line x1="12" y1="9" x2="12" y2="13"></line>
                  <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
                <div>
                  <div className="font-medium text-yellow-900">Incomplete Mappings Detected</div>
                  <div className="text-sm text-yellow-800 mt-1">
                    {mappingTables.filter(m => m.status === 'incomplete').length} mapping tables have unmapped codes.
                    Complete these to ensure accurate data imports.
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* Mapping Tables Grid */}
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            {mappingTables.map(table => (
              <div key={table.id} className="bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow">
                <div className="flex items-start justify-between mb-4">
                  <div>
                    <h3 className="text-lg font-bold text-gray-900 mb-1">{table.name}</h3>
                    <div className="text-sm text-gray-600">
                      {table.mappings} mappings ‚Ä¢ Last updated: {table.lastUpdated}
                    </div>
                  </div>
                  <span className={`px-2 py-1 rounded text-xs font-medium ${table.status === 'complete'
                    ? 'bg-green-100 text-green-800'
                    : 'bg-yellow-100 text-yellow-800'
                    }`}>
                    {table.status === 'complete' ? '‚úì Complete' : `‚ö†Ô∏è ${table.unmapped} Unmapped`}
                  </span>
                </div>
                <div className="flex gap-2">
                  <button
                    onClick={onEditMapping}
                    className="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700"
                  >
                    View & Edit
                  </button>
                  <button className="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 text-sm font-medium hover:bg-gray-50">
                    Export
                  </button>
                </div>
              </div>
            ))}
          </div>
        </div>
      );
    }

    // Code Mapping Editor
    function CodeMappingEditor({ onBack }) {
      const [searchTerm, setSearchTerm] = useState('');

      const mappings = [
        { oldCode: 'BR001', oldName: 'Main Office', newCode: 'BRANCH_01', newName: 'Headquarters', status: 'mapped', confidence: 100 },
        { oldCode: 'BR002', oldName: 'North Branch', newCode: 'BRANCH_02', newName: 'North Region', status: 'mapped', confidence: 95 },
        { oldCode: 'BR003', oldName: 'South Branch', newCode: 'BRANCH_03', newName: 'South Region', status: 'mapped', confidence: 95 },
        { oldCode: 'OLD-WEST', oldName: 'West Office', newCode: '', newName: '', status: 'unmapped', confidence: 0 },
        { oldCode: 'TEMP_BRANCH', oldName: 'Temporary Location', newCode: 'BRANCH_01', newName: 'Headquarters', status: 'mapped', confidence: 80 },
      ];

      return (
        <div className="space-y-6">
          <div>
            <button onClick={onBack} className="text-blue-600 hover:text-blue-700 mb-4 flex items-center gap-2">
              ‚Üê Back to Code Mappings
            </button>

            <div className="flex items-center justify-between">
              <div>
                <h1 className="text-2xl font-bold text-gray-900 mb-2">Branch Codes Mapping</h1>
                <p className="text-gray-600">Source: Legacy AMS (ABC Insurance) ‚Üí Target: Applied Epic</p>
              </div>
              <div className="flex gap-3">
                <button className="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50">
                  Auto-Map Similar
                </button>
                <button className="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700">
                  Save Mapping
                </button>
              </div>
            </div>
          </div>

          {/* Progress */}
          <div className="bg-white rounded-lg border border-gray-200 p-6">
            <div className="flex items-center justify-between mb-2">
              <span className="text-sm font-medium text-gray-700">Mapping Progress</span>
              <span className="text-sm font-bold text-gray-900">4/5 mapped (80%)</span>
            </div>
            <div className="w-full bg-gray-200 rounded-full h-2">
              <div className="bg-blue-600 h-2 rounded-full" style={{ width: '80%' }}></div>
            </div>
            <div className="mt-2 text-xs text-gray-600">1 code remaining to map</div>
          </div>

          {/* Mapping Table */}
          <div className="bg-white rounded-lg border border-gray-200">
            <div className="p-4 border-b border-gray-200">
              <div className="relative">
                <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" size={16} />
                <input
                  type="text"
                  placeholder="Search codes..."
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                  className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm"
                />
              </div>
            </div>

            <div className="overflow-x-auto">
              <table className="w-full">
                <thead className="bg-gray-50 border-b border-gray-200">
                  <tr>
                    <th className="text-left p-4 text-sm font-medium text-gray-600">Old Code</th>
                    <th className="text-left p-4 text-sm font-medium text-gray-600">Old Name</th>
                    <th className="text-left p-4 text-sm font-medium text-gray-600"></th>
                    <th className="text-left p-4 text-sm font-medium text-gray-600">New Code</th>
                    <th className="text-left p-4 text-sm font-medium text-gray-600">New Name</th>
                    <th className="text-left p-4 text-sm font-medium text-gray-600">Status</th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-gray-200">
                  {mappings.map((mapping, idx) => (
                    <tr key={idx} className="hover:bg-gray-50">
                      <td className="p-4">
                        <code className="text-sm bg-gray-100 px-2 py-1 rounded">{mapping.oldCode}</code>
                      </td>
                      <td className="p-4 text-sm text-gray-900">{mapping.oldName}</td>
                      <td className="p-4 text-center">
                        <span className="text-gray-400">‚Üí</span>
                      </td>
                      <td className="p-4">
                        {mapping.status === 'mapped' ? (
                          <code className="text-sm bg-blue-100 px-2 py-1 rounded text-blue-800">{mapping.newCode}</code>
                        ) : (
                          <select className="px-3 py-1 border border-gray-300 rounded text-sm">
                            <option>Select...</option>
                            <option>BRANCH_01</option>
                            <option>BRANCH_02</option>
                            <option>BRANCH_03</option>
                          </select>
                        )}
                      </td>
                      <td className="p-4 text-sm text-gray-600">{mapping.newName || '-'}</td>
                      <td className="p-4">
                        {mapping.status === 'mapped' ? (
                          <span className="flex items-center gap-1 text-sm text-green-600">
                            <Check size={16} />
                            Mapped
                            {mapping.confidence < 100 && (
                              <span className="text-xs text-gray-500">({mapping.confidence}%)</span>
                            )}
                          </span>
                        ) : (
                          <span className="flex items-center gap-1 text-sm text-yellow-600">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                              <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                              <line x1="12" y1="9" x2="12" y2="13"></line>
                              <line x1="12" y1="17" x2="12.01" y2="17"></line>
                            </svg>
                            Unmapped
                          </span>
                        )}
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      );
    }

    // Data Quality View
    function DataQualityView() {
      const qualityIssues = [
        { category: 'Missing Data', issue: 'Missing Phone Numbers', count: 234, severity: 'medium' },
        { category: 'Format Issues', issue: 'Invalid Email Formats', count: 45, severity: 'high' },
        { category: 'Duplicates', issue: 'Potential Duplicate Clients', count: 12, severity: 'medium' },
        { category: 'Data Integrity', issue: 'Unmapped Codes', count: 8, severity: 'high' },
        { category: 'Missing Data', issue: 'Missing Policy Effective Dates', count: 17, severity: 'high' },
      ];

      return (
        <div className="space-y-6">
          <div>
            <h1 className="text-2xl font-bold text-gray-900 mb-2">Data Quality</h1>
            <p className="text-gray-600">Monitor and improve your data health</p>
          </div>

          {/* Quality Score */}
          <div className="bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6">
            <div className="flex items-center justify-between">
              <div>
                <div className="text-sm font-medium text-green-700 mb-1">Overall Data Quality Score</div>
                <div className="text-5xl font-bold text-green-900">94.2%</div>
                <div className="text-sm text-green-700 mt-2">‚Üë +2.3% from last month</div>
              </div>
              <div className="text-right">
                <div className="text-sm text-green-700 mb-2">Quality Breakdown</div>
                <div className="space-y-1 text-sm">
                  <div className="flex items-center gap-2">
                    <div className="w-24 text-right text-gray-600">Completeness:</div>
                    <div className="font-medium text-gray-900">96%</div>
                  </div>
                  <div className="flex items-center gap-2">
                    <div className="w-24 text-right text-gray-600">Accuracy:</div>
                    <div className="font-medium text-gray-900">93%</div>
                  </div>
                  <div className="flex items-center gap-2">
                    <div className="w-24 text-right text-gray-600">Consistency:</div>
                    <div className="font-medium text-gray-900">95%</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          {/* Issues by Category */}
          <div className="bg-white rounded-lg border border-gray-200 p-6">
            <div className="flex items-center justify-between mb-4">
              <h2 className="text-lg font-bold text-gray-900">Issues by Category</h2>
              <button className="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700">
                Create Cleanup Workflow
              </button>
            </div>

            <div className="space-y-3">
              {qualityIssues.map((issue, idx) => (
                <div key={idx} className="flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:shadow-sm transition-shadow">
                  <div className="flex items-center gap-4">
                    <div className={`w-2 h-2 rounded-full ${issue.severity === 'high' ? 'bg-red-500' : 'bg-yellow-500'
                      }`}></div>
                    <div>
                      <div className="font-medium text-gray-900">{issue.issue}</div>
                      <div className="text-sm text-gray-600">{issue.category}</div>
                    </div>
                  </div>
                  <div className="flex items-center gap-4">
                    <div className="text-right">
                      <div className="text-2xl font-bold text-gray-900">{issue.count}</div>
                      <div className="text-xs text-gray-600">records</div>
                    </div>
                    <button className="px-3 py-1 text-sm text-blue-600 hover:text-blue-700 font-medium">
                      Fix Issues ‚Üí
                    </button>
                  </div>
                </div>
              ))}
            </div>
          </div>

          {/* Quick Actions */}
          <div className="grid grid-cols-3 gap-4">
            <button className="p-6 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-shadow text-left">
              <div className="text-3xl mb-3">üîç</div>
              <div className="font-bold text-gray-900 mb-1">Run Quality Scan</div>
              <div className="text-sm text-gray-600">Check all data for issues</div>
            </button>
            <button className="p-6 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-shadow text-left">
              <div className="text-3xl mb-3">üìã</div>
              <div className="font-bold text-gray-900 mb-1">Export Issues</div>
              <div className="text-sm text-gray-600">Download issue report</div>
            </button>
            <button className="p-6 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-shadow text-left">
              <div className="text-3xl mb-3">üìä</div>
              <div className="font-bold text-gray-900 mb-1">Quality Trends</div>
              <div className="text-sm text-gray-600">View historical data</div>
            </button>
          </div>
        </div>
      );
    }

    // Data Lake View
    function DataLakeView() {
      const [editingConnection, setEditingConnection] = useState(null);
      const [editName, setEditName] = useState('');

      const dataLakeStatus = {
        status: 'healthy',
        lastSync: '2 hours ago',
        totalRecords: '2.4M',
        storageUsed: '847 GB',
        storageLimit: '2 TB',
        syncFrequency: 'Real-time',
        dataSources: 12,
        tables: 156,
        lastFullBackup: 'Yesterday at 2:00 AM'
      };

      const [serviceAccounts, setServiceAccounts] = useState([
        {
          id: 'sa1',
          serviceAccountId: 'svc-data-lake-001',
          name: 'Tableau Production',
          status: 'active',
          lastUsed: '3 hours ago',
          dataVolume: '12.4 GB',
          requestsLast30Days: 1847,
          createdDate: '2024-01-15',
          createdBy: 'John Smith'
        },
        {
          id: 'sa2',
          serviceAccountId: 'svc-data-lake-002',
          name: 'Power BI Analytics',
          status: 'active',
          lastUsed: '1 day ago',
          dataVolume: '8.2 GB',
          requestsLast30Days: 923,
          createdDate: '2024-02-20',
          createdBy: 'Sarah Johnson'
        },
        {
          id: 'sa3',
          serviceAccountId: 'svc-data-lake-003',
          name: 'Snowflake Warehouse',
          status: 'active',
          lastUsed: '5 minutes ago',
          dataVolume: '45.7 GB',
          requestsLast30Days: 2156,
          createdDate: '2024-03-10',
          createdBy: 'Mike Wilson'
        },
        {
          id: 'sa4',
          serviceAccountId: 'svc-data-lake-004',
          name: 'Databricks ML',
          status: 'active',
          lastUsed: '2 hours ago',
          dataVolume: '23.1 GB',
          requestsLast30Days: 1243,
          createdDate: '2024-04-05',
          createdBy: 'Emily Davis'
        },
        {
          id: 'sa5',
          serviceAccountId: 'svc-data-lake-005',
          name: 'Looker Analytics',
          status: 'active',
          lastUsed: 'Never',
          dataVolume: '0 GB',
          requestsLast30Days: 0,
          createdDate: '2024-11-28',
          createdBy: 'David Brown'
        }
      ]);

      const handleEditName = (account) => {
        setEditingConnection(account.id);
        setEditName(account.name);
      };

      const handleSaveName = (accountId) => {
        setServiceAccounts(accounts =>
          accounts.map(acc =>
            acc.id === accountId ? { ...acc, name: editName } : acc
          )
        );
        setEditingConnection(null);
        setEditName('');
      };

      const handleCancelEdit = () => {
        setEditingConnection(null);
        setEditName('');
      };

      return (
        <div className="space-y-6">
          <div>
            <h1 className="text-2xl font-bold text-gray-900 mb-2">Data Lake</h1>
            <p className="text-gray-600">Monitor your data lake status and manage service connections for 3rd party analytics</p>
          </div>

          {/* Data Lake Status */}
          <div className="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6">
            <div className="flex items-start justify-between mb-4">
              <div>
                <div className="flex items-center gap-3 mb-2">
                  <div className={`w-3 h-3 rounded-full ${dataLakeStatus.status === 'healthy' ? 'bg-green-500' : 'bg-yellow-500'} animate-pulse`}></div>
                  <h2 className="text-xl font-bold text-gray-900">Data Lake Status: {dataLakeStatus.status.toUpperCase()}</h2>
                </div>
                <p className="text-sm text-gray-600">Last sync: {dataLakeStatus.lastSync}</p>
              </div>
              <button className="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700">
                Refresh Status
              </button>
            </div>

            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div className="bg-white rounded-lg p-4 border border-gray-200">
                <div className="text-sm text-gray-600 mb-1">Total Records</div>
                <div className="text-2xl font-bold text-gray-900">{dataLakeStatus.totalRecords}</div>
              </div>
              <div className="bg-white rounded-lg p-4 border border-gray-200">
                <div className="text-sm text-gray-600 mb-1">Storage Used</div>
                <div className="text-2xl font-bold text-gray-900">{dataLakeStatus.storageUsed}</div>
                <div className="text-xs text-gray-500 mt-1">of {dataLakeStatus.storageLimit}</div>
              </div>
              <div className="bg-white rounded-lg p-4 border border-gray-200">
                <div className="text-sm text-gray-600 mb-1">Data Sources</div>
                <div className="text-2xl font-bold text-gray-900">{dataLakeStatus.dataSources}</div>
              </div>
              <div className="bg-white rounded-lg p-4 border border-gray-200">
                <div className="text-sm text-gray-600 mb-1">Tables</div>
                <div className="text-2xl font-bold text-gray-900">{dataLakeStatus.tables}</div>
              </div>
            </div>

            <div className="mt-4 pt-4 border-t border-blue-200">
              <div className="grid grid-cols-2 gap-4 text-sm">
                <div>
                  <span className="text-gray-600">Sync Frequency:</span>
                  <span className="ml-2 font-medium text-gray-900">{dataLakeStatus.syncFrequency}</span>
                </div>
                <div>
                  <span className="text-gray-600">Last Full Backup:</span>
                  <span className="ml-2 font-medium text-gray-900">{dataLakeStatus.lastFullBackup}</span>
                </div>
              </div>
            </div>
          </div>

          {/* Service Accounts */}
          <div className="bg-white rounded-lg border border-gray-200 p-6">
            <div className="flex items-center justify-between mb-4">
              <div>
                <h2 className="text-lg font-bold text-gray-900">Service Accounts</h2>
                <p className="text-sm text-gray-600 mt-1">Associate names with service accounts for 3rd party analytics platforms</p>
              </div>
            </div>

            <div className="space-y-3">
              {serviceAccounts.map(account => (
                <div key={account.id} className="border border-gray-200 rounded-lg p-4 hover:shadow-sm transition-shadow">
                  <div className="flex items-start justify-between">
                    <div className="flex-1">
                      <div className="flex items-center gap-3 mb-3">
                        {editingConnection === account.id ? (
                          <div className="flex items-center gap-2 flex-1">
                            <input
                              type="text"
                              value={editName}
                              onChange={(e) => setEditName(e.target.value)}
                              className="px-3 py-1.5 border border-blue-300 rounded-lg text-sm font-medium flex-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                              placeholder="Enter connection name"
                              autoFocus
                            />
                            <button
                              onClick={() => handleSaveName(account.id)}
                              className="px-3 py-1.5 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700"
                            >
                              Save
                            </button>
                            <button
                              onClick={handleCancelEdit}
                              className="px-3 py-1.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50"
                            >
                              Cancel
                            </button>
                          </div>
                        ) : (
                          <>
                            <h3 className="font-bold text-gray-900">{account.name}</h3>
                            <button
                              onClick={() => handleEditName(account)}
                              className="text-blue-600 hover:text-blue-700 text-sm font-medium"
                            >
                              Edit Name
                            </button>
                            <span className={`px-2 py-1 rounded text-xs font-medium ${account.status === 'active'
                              ? 'bg-green-100 text-green-800'
                              : 'bg-yellow-100 text-yellow-800'
                              }`}>
                              {account.status === 'active' ? '‚úì Active' : '‚è≥ Inactive'}
                            </span>
                          </>
                        )}
                      </div>

                      <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-3">
                        <div>
                          <div className="text-xs text-gray-500 mb-1">Service Account ID</div>
                          <div className="text-sm font-mono text-gray-900">{account.serviceAccountId}</div>
                        </div>
                        <div>
                          <div className="text-xs text-gray-500 mb-1">Last Used</div>
                          <div className="text-sm font-medium text-gray-900">{account.lastUsed}</div>
                        </div>
                        <div>
                          <div className="text-xs text-gray-500 mb-1">Data Volume</div>
                          <div className="text-sm font-medium text-gray-900">{account.dataVolume}</div>
                        </div>
                        <div>
                          <div className="text-xs text-gray-500 mb-1">Requests (30 days)</div>
                          <div className="text-sm font-medium text-gray-900">{account.requestsLast30Days.toLocaleString()}</div>
                        </div>
                      </div>

                      <div className="flex items-center gap-4 text-xs text-gray-500 pt-2 border-t border-gray-100">
                        <span>Created: {new Date(account.createdDate).toLocaleDateString()}</span>
                        <span>‚Ä¢</span>
                        <span>By: {account.createdBy}</span>
                      </div>
                    </div>
                    <div className="flex gap-2 ml-4">
                      <button className="px-3 py-1 text-sm text-blue-600 hover:text-blue-700 font-medium border border-blue-200 rounded-lg hover:bg-blue-50">
                        View Credentials
                      </button>
                      <button className="p-1 text-gray-400 hover:text-gray-600">
                        <MoreVertical size={18} />
                      </button>
                    </div>
                  </div>
                </div>
              ))}
            </div>

            {serviceAccounts.length === 0 && (
              <div className="text-center py-12 text-gray-500">
                <div className="text-4xl mb-4">üìä</div>
                <div className="font-medium text-gray-900">No service accounts available</div>
                <div className="text-sm text-gray-600 mt-1">Contact your administrator to provision service accounts</div>
              </div>
            )}
          </div>

          {/* Quick Actions */}
          <div className="grid grid-cols-3 gap-4">
            <button className="p-6 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-shadow text-left">
              <div className="text-3xl mb-3">üîÑ</div>
              <div className="font-bold text-gray-900 mb-1">Sync Now</div>
              <div className="text-sm text-gray-600">Trigger immediate data sync</div>
            </button>
            <button className="p-6 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-shadow text-left">
              <div className="text-3xl mb-3">üìä</div>
              <div className="font-bold text-gray-900 mb-1">View Schema</div>
              <div className="text-sm text-gray-600">Browse data lake structure</div>
            </button>
            <button className="p-6 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-shadow text-left">
              <div className="text-3xl mb-3">üì•</div>
              <div className="font-bold text-gray-900 mb-1">Export Metadata</div>
              <div className="text-sm text-gray-600">Download schema documentation</div>
            </button>
          </div>
        </div>
      );
    }

    // Import Wizard (placeholder)
    function ImportWizard({ onBack }) {
      return (
        <div className="max-w-4xl mx-auto">
          <button onClick={onBack} className="text-blue-600 hover:text-blue-700 mb-4 flex items-center gap-2">
            ‚Üê Back to Manual Operations
          </button>
          <div className="bg-white rounded-lg border border-gray-200 p-8 text-center">
            <div className="text-5xl mb-4">üì•</div>
            <h2 className="text-2xl font-bold text-gray-900 mb-2">Import Wizard</h2>
            <p className="text-gray-600 mb-6">Step-by-step guided data import with field mapping and validation</p>
            <div className="text-sm text-gray-500">
              Full import wizard interface coming in next iteration
            </div>
          </div>
        </div>
      );
    }

    // Schedule Tab Content
    function ScheduleTabContent({ timelineView, setTimelineView }) {
      return (
        <div className="space-y-6">
          <div className="flex items-center justify-between">
            <div>
              <h2 className="text-xl font-bold text-gray-900">Automation Schedule</h2>
              <p className="text-sm text-gray-600 mt-1">View when your automations are scheduled to run</p>
            </div>
            <div className="flex items-center gap-3">
              <button
                onClick={() => setTimelineView('week')}
                className={`px-4 py-2 rounded-lg font-medium transition-colors ${timelineView === 'week'
                  ? 'bg-blue-600 text-white'
                  : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'
                  }`}
              >
                Week View
              </button>
              <button
                onClick={() => setTimelineView('month')}
                className={`px-4 py-2 rounded-lg font-medium transition-colors ${timelineView === 'month'
                  ? 'bg-blue-600 text-white'
                  : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'
                  }`}
              >
                Month View
              </button>
            </div>
          </div>

          {timelineView === 'week' ? (
            <WeekTimelineView />
          ) : (
            <MonthCalendarView />
          )}
        </div>
      );
    }

    // Active Automations Tab Content
    function ActiveAutomationsTabContent({ onViewAutomation }) {
      const [filterStatus, setFilterStatus] = useState('all'); // 'all', 'active', 'paused'
      const [filterType, setFilterType] = useState('all'); // 'all', 'insights', 'standard'
      const [searchTerm, setSearchTerm] = useState('');

      const filteredAutomations = sampleAutomations.filter(auto => {
        const matchesStatus = filterStatus === 'all' || auto.status === filterStatus;
        const matchesType = filterType === 'all' || auto.type === filterType;
        const matchesSearch = auto.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
          auto.description.toLowerCase().includes(searchTerm.toLowerCase());
        return matchesStatus && matchesType && matchesSearch;
      });

      return (
        <div className="space-y-6">


          {/* Search and Filters */}
          <div className="bg-white border border-gray-200 rounded-lg p-4">
            <div className="space-y-4">
              {/* Search Bar */}
              <div className="relative">
                <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" size={16} />
                <input
                  type="text"
                  placeholder="Search automations..."
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                  className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                />
              </div>

              {/* Filter Groups */}
              <div className="flex flex-wrap items-center gap-4">
                {/* Type Filters */}
                <div className="flex items-center gap-2">
                  <span className="text-xs font-semibold text-gray-500 uppercase tracking-wide">Type:</span>
                  <div className="flex gap-2">
                    <button
                      onClick={() => setFilterType('all')}
                      className={`px-3 py-1.5 rounded-lg font-medium text-sm transition-colors ${filterType === 'all'
                        ? 'bg-purple-600 text-white'
                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                        }`}
                    >
                      All ({sampleAutomations.length})
                    </button>
                    <button
                      onClick={() => setFilterType('insights')}
                      className={`px-3 py-1.5 rounded-lg font-medium text-sm transition-colors flex items-center gap-1.5 ${filterType === 'insights'
                        ? 'bg-purple-600 text-white'
                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                        }`}
                    >
                      <Brain size={14} />
                      Insights ({sampleAutomations.filter(a => a.type === 'insights').length})
                    </button>
                    <button
                      onClick={() => setFilterType('standard')}
                      className={`px-3 py-1.5 rounded-lg font-medium text-sm transition-colors ${filterType === 'standard'
                        ? 'bg-blue-600 text-white'
                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                        }`}
                    >
                      Standard ({sampleAutomations.filter(a => a.type === 'standard').length})
                    </button>
                  </div>
                </div>

                {/* Status Filters */}
                <div className="flex items-center gap-2">
                  <span className="text-xs font-semibold text-gray-500 uppercase tracking-wide">Status:</span>
                  <div className="flex gap-2">
                    <button
                      onClick={() => setFilterStatus('all')}
                      className={`px-3 py-1.5 rounded-lg font-medium text-sm transition-colors ${filterStatus === 'all'
                        ? 'bg-blue-600 text-white'
                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                        }`}
                    >
                      All
                    </button>
                    <button
                      onClick={() => setFilterStatus('active')}
                      className={`px-3 py-1.5 rounded-lg font-medium text-sm transition-colors ${filterStatus === 'active'
                        ? 'bg-green-600 text-white'
                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                        }`}
                    >
                      Active ({sampleAutomations.filter(a => a.status === 'active').length})
                    </button>
                    <button
                      onClick={() => setFilterStatus('paused')}
                      className={`px-3 py-1.5 rounded-lg font-medium text-sm transition-colors ${filterStatus === 'paused'
                        ? 'bg-yellow-600 text-white'
                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                        }`}
                    >
                      Paused ({sampleAutomations.filter(a => a.status === 'paused').length})
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          {/* Automations List */}
          <div className="space-y-4">
            {filteredAutomations.length > 0 ? (
              filteredAutomations.map(automation => (
                <AutomationCard
                  key={automation.id}
                  automation={automation}
                  onView={onViewAutomation}
                />
              ))
            ) : (
              <div className="text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300">
                <div className="text-4xl mb-4">üîç</div>
                <div className="font-medium text-gray-900">No automations found</div>
                <div className="text-sm text-gray-600 mt-1">Try adjusting your search or filters</div>
              </div>
            )}
          </div>
        </div>
      );
    }

    // Week Timeline View Component
    function WeekTimelineView() {
      const weekDays = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
      const currentDate = new Date();

      // Generate sample schedule data
      const scheduleData = {
        'Monday': [
          { time: '08:00 AM', name: 'New Client Onboarding', icon: 'üëã', color: 'blue', records: 18 },
          { time: '09:00 AM', name: '60-Day Renewal Reminder', icon: 'üîÑ', color: 'green', records: 247 },
          { time: '10:00 AM', name: 'Quote Follow-Up', icon: 'üìã', color: 'purple', records: 42 }
        ],
        'Tuesday': [
          { time: '09:00 AM', name: '60-Day Renewal Reminder', icon: 'üîÑ', color: 'green', records: 243 },
          { time: '10:00 AM', name: 'Quote Follow-Up', icon: 'üìã', color: 'purple', records: 38 }
        ],
        'Wednesday': [
          { time: '09:00 AM', name: '60-Day Renewal Reminder', icon: 'üîÑ', color: 'green', records: 251 },
          { time: '10:00 AM', name: 'Quote Follow-Up', icon: 'üìã', color: 'purple', records: 45 },
          { time: '02:00 PM', name: 'Policy Lapse Prevention', icon: 'üõ°Ô∏è', color: 'red', records: 31 }
        ],
        'Thursday': [
          { time: '09:00 AM', name: '60-Day Renewal Reminder', icon: 'üîÑ', color: 'green', records: 239 },
          { time: '10:00 AM', name: 'Quote Follow-Up', icon: 'üìã', color: 'purple', records: 41 }
        ],
        'Friday': [
          { time: '01:00 PM', name: 'High-Value Client Review', icon: '‚≠ê', color: 'yellow', records: 89 },
          { time: '09:00 AM', name: '60-Day Renewal Reminder', icon: 'üîÑ', color: 'green', records: 245 },
          { time: '10:00 AM', name: 'Quote Follow-Up', icon: 'üìã', color: 'purple', records: 44 }
        ],
        'Saturday': [],
        'Sunday': []
      };

      return (
        <div className="space-y-4">
          {/* Date Navigation */}
          <div className="flex items-center justify-between pb-4 border-b border-gray-200">
            <button className="p-2 hover:bg-gray-100 rounded-lg text-gray-600">
              ‚Üê Previous Week
            </button>
            <div className="text-center">
              <div className="font-bold text-gray-900">December 16 - December 22, 2024</div>
              <div className="text-sm text-gray-600">This Week</div>
            </div>
            <button className="p-2 hover:bg-gray-100 rounded-lg text-gray-600">
              Next Week ‚Üí
            </button>
          </div>

          {/* Timeline Grid */}
          <div className="grid grid-cols-7 gap-3">
            {weekDays.map((day, idx) => {
              const isToday = idx === 2; // Wednesday for demo
              const schedules = scheduleData[day] || [];

              return (
                <div key={day} className={`rounded-lg border-2 ${isToday ? 'border-blue-500 bg-blue-50' : 'border-gray-200 bg-white'}`}>
                  <div className={`p-3 border-b ${isToday ? 'border-blue-200 bg-blue-100' : 'border-gray-200'}`}>
                    <div className="font-bold text-sm text-gray-900">{day.substring(0, 3)}</div>
                    <div className={`text-xs ${isToday ? 'text-blue-600 font-bold' : 'text-gray-600'}`}>
                      Dec {16 + idx}
                      {isToday && ' (Today)'}
                    </div>
                  </div>
                  <div className="p-2 space-y-2 min-h-[300px]">
                    {schedules.length > 0 ? (
                      schedules.map((schedule, sidx) => (
                        <ScheduleCard key={sidx} schedule={schedule} compact={true} />
                      ))
                    ) : (
                      <div className="text-center text-gray-400 text-xs pt-8">
                        No automations scheduled
                      </div>
                    )}
                  </div>
                </div>
              );
            })}
          </div>

          {/* Legend */}
          <div className="flex items-center gap-4 pt-4 border-t border-gray-200">
            <span className="text-sm font-medium text-gray-700">Status:</span>
            <div className="flex items-center gap-2">
              <div className="w-3 h-3 rounded-full bg-green-500"></div>
              <span className="text-xs text-gray-600">Completed</span>
            </div>
            <div className="flex items-center gap-2">
              <div className="w-3 h-3 rounded-full bg-blue-500"></div>
              <span className="text-xs text-gray-600">Scheduled</span>
            </div>
            <div className="flex items-center gap-2">
              <div className="w-3 h-3 rounded-full bg-gray-300"></div>
              <span className="text-xs text-gray-600">Paused</span>
            </div>
          </div>
        </div>
      );
    }

    // Month Calendar View Component
    function MonthCalendarView() {
      const daysInMonth = 31;
      const firstDayOfWeek = 0; // Sunday
      const monthName = 'December 2024';

      // Generate calendar grid
      const calendarDays = [];
      for (let i = 0; i < firstDayOfWeek; i++) {
        calendarDays.push(null);
      }
      for (let i = 1; i <= daysInMonth; i++) {
        calendarDays.push(i);
      }

      // Sample automation counts per day
      const automationCounts = {
        16: 3, 17: 2, 18: 4, 19: 2, 20: 4, 21: 0, 22: 0,
        23: 3, 24: 2, 25: 0, 26: 0, 27: 2, 28: 0, 29: 0,
        30: 3, 31: 2
      };

      // Detailed schedule for selected day
      const selectedDaySchedule = [
        { time: '09:00 AM', name: '60-Day Renewal Reminder', icon: 'üîÑ', color: 'green', records: 247, status: 'completed' },
        { time: '10:00 AM', name: 'Quote Follow-Up', icon: 'üìã', color: 'purple', records: 42, status: 'completed' },
        { time: '02:00 PM', name: 'Policy Lapse Prevention', icon: 'üõ°Ô∏è', color: 'red', records: 31, status: 'scheduled' },
        { time: '03:30 PM', name: 'Cross-Sell Opportunity', icon: 'üéØ', color: 'orange', records: 124, status: 'scheduled' }
      ];

      const [selectedDay, setSelectedDay] = useState(18);

      return (
        <div className="space-y-4">
          {/* Month Navigation */}
          <div className="flex items-center justify-between pb-4 border-b border-gray-200">
            <button className="p-2 hover:bg-gray-100 rounded-lg text-gray-600">
              ‚Üê Previous Month
            </button>
            <div className="text-center">
              <div className="font-bold text-gray-900">{monthName}</div>
            </div>
            <button className="p-2 hover:bg-gray-100 rounded-lg text-gray-600">
              Next Month ‚Üí
            </button>
          </div>

          <div className="grid grid-cols-7 gap-2">
            {/* Day Headers */}
            {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (
              <div key={day} className="text-center text-xs font-semibold text-gray-600 py-2">
                {day}
              </div>
            ))}

            {/* Calendar Days */}
            {calendarDays.map((day, idx) => {
              if (day === null) {
                return <div key={`empty-${idx}`} className="aspect-square"></div>;
              }

              const count = automationCounts[day] || 0;
              const isToday = day === 18;
              const isSelected = day === selectedDay;

              return (
                <button
                  key={day}
                  onClick={() => setSelectedDay(day)}
                  className={`aspect-square p-2 rounded-lg border-2 transition-all ${isSelected
                    ? 'border-blue-500 bg-blue-50'
                    : isToday
                      ? 'border-blue-300 bg-blue-50'
                      : count > 0
                        ? 'border-gray-200 hover:border-gray-300 bg-white'
                        : 'border-gray-100 bg-gray-50'
                    }`}
                >
                  <div className={`text-sm font-bold ${isToday ? 'text-blue-600' : 'text-gray-900'}`}>
                    {day}
                  </div>
                  {count > 0 && (
                    <div className="flex flex-wrap gap-0.5 mt-1">
                      {Array.from({ length: Math.min(count, 6) }).map((_, i) => (
                        <div
                          key={i}
                          className={`w-1.5 h-1.5 rounded-full ${i === 0 ? 'bg-green-500' : i === 1 ? 'bg-purple-500' : 'bg-blue-500'
                            }`}
                        />
                      ))}
                    </div>
                  )}
                  {count > 0 && (
                    <div className="text-xs text-gray-600 mt-1">{count}</div>
                  )}
                </button>
              );
            })}
          </div>

          {/* Selected Day Details */}
          <div className="bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-6 mt-6">
            <div className="flex items-center justify-between mb-4">
              <h3 className="font-bold text-gray-900 text-lg">
                Wednesday, December {selectedDay}, 2024
              </h3>
              <span className="px-3 py-1 bg-blue-600 text-white text-sm font-medium rounded-full">
                {selectedDaySchedule.length} Automations
              </span>
            </div>

            <div className="space-y-3">
              {selectedDaySchedule.map((schedule, idx) => (
                <ScheduleCard key={idx} schedule={schedule} compact={false} />
              ))}
            </div>
          </div>

          {/* Monthly Stats */}
          <div className="grid grid-cols-3 gap-4 pt-4 border-t border-gray-200">
            <div className="bg-white rounded-lg p-4 border border-gray-200">
              <div className="text-2xl font-bold text-gray-900">47</div>
              <div className="text-sm text-gray-600">Total Runs This Month</div>
            </div>
            <div className="bg-white rounded-lg p-4 border border-gray-200">
              <div className="text-2xl font-bold text-gray-900">12</div>
              <div className="text-sm text-gray-600">Active Automations</div>
            </div>
            <div className="bg-white rounded-lg p-4 border border-gray-200">
              <div className="text-2xl font-bold text-gray-900">8,942</div>
              <div className="text-sm text-gray-600">Records Processed</div>
            </div>
          </div>
        </div>
      );
    }

    // Schedule Card Component
    function ScheduleCard({ schedule, compact }) {
      const statusColors = {
        completed: 'bg-green-100 text-green-800 border-green-200',
        scheduled: 'bg-blue-100 text-blue-800 border-blue-200',
        running: 'bg-yellow-100 text-yellow-800 border-yellow-200',
        failed: 'bg-red-100 text-red-800 border-red-200'
      };

      if (compact) {
        return (
          <div className="bg-white border border-gray-200 rounded-lg p-2 hover:shadow-md transition-shadow cursor-pointer">
            <div className="flex items-start gap-2">
              <span className="text-lg">{schedule.icon}</span>
              <div className="flex-1 min-w-0">
                <div className="text-xs font-bold text-gray-900 truncate">{schedule.name}</div>
                <div className="text-xs text-gray-600">{schedule.time}</div>
                <div className="text-xs text-gray-500 mt-1">{schedule.records} records</div>
              </div>
            </div>
          </div>
        );
      }

      return (
        <div className="bg-white border-2 border-gray-200 rounded-lg p-4 hover:border-blue-300 hover:shadow-md transition-all cursor-pointer">
          <div className="flex items-start justify-between">
            <div className="flex items-start gap-3 flex-1">
              <span className="text-2xl">{schedule.icon}</span>
              <div className="flex-1">
                <div className="font-bold text-gray-900 mb-1">{schedule.name}</div>
                <div className="flex items-center gap-3 text-sm text-gray-600">
                  <div className="flex items-center gap-1">
                    <Clock size={14} />
                    <span>{schedule.time}</span>
                  </div>
                  <div className="flex items-center gap-1">
                    <Users size={14} />
                    <span>{schedule.records} records</span>
                  </div>
                </div>
              </div>
            </div>
            {schedule.status && (
              <span className={`px-2 py-1 rounded text-xs font-medium border ${statusColors[schedule.status]}`}>
                {schedule.status}
              </span>
            )}
          </div>
        </div>
      );
    }

    // Templates View
    // Trigger Type Selector - First step in automation creation
    function TriggerTypeSelector({ onSelectTriggerType }) {
      const triggerTypes = [
        {
          id: 'anomaly',
          name: 'Anomaly Detection',
          description: 'Detect unusual spikes or drops in metrics using statistical analysis',
          icon: 'üö®',
          category: 'insights',
          color: 'red',
          examples: ['Cancellation spike alerts', 'Revenue anomalies', 'Unusual activity patterns']
        },
        {
          id: 'predictive',
          name: 'Predictive Forecast',
          description: 'Forecast future trends and alert before targets are missed',
          icon: 'üîÆ',
          category: 'insights',
          color: 'purple',
          examples: ['Client retention forecast', 'Policy churn prediction', 'Renewal rate warnings']
        },
        {
          id: 'threshold',
          name: 'Threshold Monitor',
          description: 'Alert when metrics cross defined thresholds',
          icon: '‚ö†Ô∏è',
          category: 'insights',
          color: 'yellow',
          examples: ['Activities past expiration', 'Activities per employee', 'Overdue follow-ups threshold']
        },
        {
          id: 'trend',
          name: 'Trend Analysis',
          description: 'Monitor trends over time and alert on concerning patterns',
          icon: 'üìà',
          category: 'insights',
          color: 'blue',
          examples: ['Renewal rate trends', 'Sales velocity', 'Customer engagement']
        },
        {
          id: 'pattern',
          name: 'Pattern Recognition',
          description: 'Detect recurring patterns or unexpected behaviors',
          icon: 'üîç',
          category: 'insights',
          color: 'indigo',
          examples: ['Duplicate detection', 'Fraud patterns', 'Behavior clustering']
        },
        {
          id: 'comparative',
          name: 'Comparative Analysis',
          description: 'Compare performance across entities and identify outliers',
          icon: 'üèÜ',
          category: 'insights',
          color: 'green',
          examples: ['Office performance', 'Team benchmarking', 'Regional comparison']
        },
        {
          id: 'composite',
          name: 'Multi-Factor Analysis',
          description: 'Combine multiple indicators for sophisticated risk scoring',
          icon: 'üéØ',
          category: 'insights',
          color: 'pink',
          examples: ['Churn risk: Activities + Quote timeframe', 'Compliance risk scoring', 'Client health scores']
        },
        {
          id: 'scheduled',
          name: 'Scheduled / Time-Based',
          description: 'Run on a regular schedule (daily, weekly, monthly)',
          icon: 'üìÖ',
          category: 'standard',
          color: 'gray',
          examples: ['Renewal reminders', 'Weekly reports', 'Daily follow-ups']
        }
      ];

      const insightsTriggers = triggerTypes.filter(t => t.category === 'insights');
      const standardTriggers = triggerTypes.filter(t => t.category === 'standard');

      return (
        <div className="max-w-6xl mx-auto space-y-6">
          <div>
            <h1 className="text-3xl font-bold text-gray-900 mb-2">Create New Automation</h1>
            <p className="text-gray-600">First, choose what should trigger your automation</p>
          </div>

          {/* Natural Language Option */}
          <div className="bg-gradient-to-r from-purple-50 to-blue-50 border-2 border-purple-300 rounded-xl p-6 hover:shadow-lg transition-all">
            <div className="flex items-start justify-between">
              <div className="flex items-start gap-4 flex-1">
                <div className="text-4xl">‚ú®</div>
                <div className="flex-1">
                  <div className="flex items-center gap-2 mb-2">
                    <h2 className="text-xl font-bold text-gray-900">Try our new natural language-based creation</h2>
                    <span className="px-2 py-1 bg-purple-600 text-white text-xs font-bold rounded">NEW</span>
                  </div>
                  <p className="text-sm text-gray-700 mb-3">
                    Describe your automation in plain English. We'll ask clarifying questions or you can provide all details at once.
                  </p>
                  <div className="text-xs text-gray-600 space-y-1 mb-4">
                    <div>üí¨ Example: "Send renewal reminders to policies expiring in 60 days, daily at 9 AM"</div>
                    <div>üí¨ Example: "Alert me when cancellation rate spikes above normal"</div>
                  </div>
                  <button
                    onClick={() => onSelectTriggerType({ id: 'natural-language', name: 'Natural Language', category: 'natural-language' })}
                    className="px-6 py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 flex items-center gap-2 transition-colors"
                  >
                    <Brain size={20} />
                    Create with Natural Language
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div className="relative">
            <div className="absolute inset-0 flex items-center">
              <div className="w-full border-t border-gray-300"></div>
            </div>
            <div className="relative flex justify-center text-sm">
              <span className="px-4 bg-gray-50 text-gray-500 font-medium">OR</span>
            </div>
          </div>

          {/* Insights-Based Triggers */}
          <div>
            <div className="flex items-center gap-3 mb-4">
              <Brain size={28} className="text-purple-600" />
              <div>
                <h2 className="text-xl font-bold text-gray-900">Insights-Based Triggers</h2>
                <p className="text-sm text-gray-600">AI-powered triggers that detect patterns and anomalies</p>
              </div>
            </div>

            <div className="grid grid-cols-2 gap-4">
              {insightsTriggers.map(trigger => (
                <button
                  key={trigger.id}
                  onClick={() => onSelectTriggerType(trigger)}
                  className={`text-left bg-white border-2 border-gray-200 rounded-xl p-6 hover:border-purple-400 hover:shadow-lg transition-all`}
                >
                  <div className="flex items-start gap-4">
                    <div className="text-5xl">{trigger.icon}</div>
                    <div className="flex-1">
                      <h3 className="text-lg font-bold text-gray-900 mb-1">{trigger.name}</h3>
                      <p className="text-sm text-gray-600 mb-3">{trigger.description}</p>
                      <div className="space-y-1">
                        <div className="text-xs font-medium text-gray-500">Examples:</div>
                        {trigger.examples.slice(0, 2).map((ex, idx) => (
                          <div key={idx} className="text-xs text-gray-600">‚Ä¢ {ex}</div>
                        ))}
                      </div>
                    </div>
                  </div>
                </button>
              ))}
            </div>
          </div>

          {/* Standard Triggers */}
          <div>
            <div className="flex items-center gap-3 mb-4">
              <Clock size={28} className="text-blue-600" />
              <div>
                <h2 className="text-xl font-bold text-gray-900">Standard Triggers</h2>
                <p className="text-sm text-gray-600">Traditional time-based and query-based automations</p>
              </div>
            </div>

            <div className="grid grid-cols-2 gap-4">
              {standardTriggers.map(trigger => (
                <button
                  key={trigger.id}
                  onClick={() => onSelectTriggerType(trigger)}
                  className="text-left bg-white border-2 border-gray-200 rounded-xl p-6 hover:border-blue-400 hover:shadow-lg transition-all"
                >
                  <div className="flex items-start gap-4">
                    <div className="text-5xl">{trigger.icon}</div>
                    <div className="flex-1">
                      <h3 className="text-lg font-bold text-gray-900 mb-1">{trigger.name}</h3>
                      <p className="text-sm text-gray-600 mb-3">{trigger.description}</p>
                      <div className="space-y-1">
                        <div className="text-xs font-medium text-gray-500">Examples:</div>
                        {trigger.examples.map((ex, idx) => (
                          <div key={idx} className="text-xs text-gray-600">‚Ä¢ {ex}</div>
                        ))}
                      </div>
                    </div>
                  </div>
                </button>
              ))}
            </div>
          </div>

          <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
            <div className="flex items-start gap-3">
              <div className="text-blue-600 text-xl">üí°</div>
              <div>
                <h4 className="font-medium text-blue-900 mb-1">Need help choosing?</h4>
                <p className="text-sm text-blue-800">
                  <strong>Insights triggers</strong> analyze your data continuously and fire when patterns are detected.
                  <strong> Standard triggers</strong> run on a schedule and process records that match your query.
                </p>
              </div>
            </div>
          </div>
        </div>
      );
    }

    // Natural Language Builder Component
    function NaturalLanguageBuilder({ onBack, onComplete }) {
      const [mode, setMode] = useState('direct'); // 'direct' or 'conversational'
      const [input, setInput] = useState('');
      const [conversation, setConversation] = useState([]);
      const [currentQuestion, setCurrentQuestion] = useState(null);
      const [isProcessing, setIsProcessing] = useState(false);
      const [parsedAutomation, setParsedAutomation] = useState(null);

      // Sample questions for conversational mode
      const questionFlow = [
        {
          id: 'trigger',
          question: "What should trigger this automation? (e.g., 'policies expiring in 60 days', 'when cancellation rate spikes', 'daily at 9 AM')",
          type: 'text',
          key: 'trigger'
        },
        {
          id: 'actions',
          question: "What actions should happen? (e.g., 'send email campaign', 'create activity', 'send notification')",
          type: 'text',
          key: 'actions'
        },
        {
          id: 'schedule',
          question: "When should this run? (e.g., 'daily at 9 AM', 'weekly on Monday', 'every 6 hours')",
          type: 'text',
          key: 'schedule'
        }
      ];

      const handleDirectSubmit = () => {
        if (!input.trim()) return;

        setIsProcessing(true);

        // Simulate AI processing
        setTimeout(() => {
          // Parse the input (in real implementation, this would call an AI service)
          const parsed = parseNaturalLanguage(input);
          setParsedAutomation(parsed);
          setIsProcessing(false);
        }, 2000);
      };

      const handleConversationalStart = () => {
        setConversation([]);
        setCurrentQuestion(questionFlow[0]);
      };

      const handleConversationalAnswer = (answer) => {
        const newConversation = [...conversation, {
          question: currentQuestion.question,
          answer: answer,
          key: currentQuestion.key
        }];

        setConversation(newConversation);

        // Find next question
        const currentIndex = questionFlow.findIndex(q => q.id === currentQuestion.id);
        if (currentIndex < questionFlow.length - 1) {
          setCurrentQuestion(questionFlow[currentIndex + 1]);
        } else {
          // All questions answered, parse the conversation
          setIsProcessing(true);
          setTimeout(() => {
            const parsed = parseConversation(newConversation);
            setParsedAutomation(parsed);
            setIsProcessing(false);
          }, 1500);
        }
      };

      const parseNaturalLanguage = (text) => {
        // Simplified parsing - in real implementation, this would use AI/NLP
        const lowerText = text.toLowerCase();

        // Extract trigger
        let trigger = 'scheduled';
        let triggerDetails = {};
        if (lowerText.includes('expiring') || lowerText.includes('expire')) {
          trigger = 'scheduled';
          const daysMatch = text.match(/(\d+)\s*days?/i);
          triggerDetails = {
            entity: 'Policies',
            condition: daysMatch ? `Expiring in ${daysMatch[1]} days` : 'Expiring soon'
          };
        } else if (lowerText.includes('spike') || lowerText.includes('anomaly')) {
          trigger = 'anomaly';
          triggerDetails = {
            entity: 'Metrics',
            condition: 'Detect unusual spikes'
          };
        }

        // Extract actions
        const actions = [];
        if (lowerText.includes('send') && (lowerText.includes('email') || lowerText.includes('campaign'))) {
          actions.push('Send Campaign');
        }
        if (lowerText.includes('create') && lowerText.includes('activity')) {
          actions.push('Create Activity');
        }
        if (lowerText.includes('notification') || lowerText.includes('alert')) {
          actions.push('Send Notification');
        }

        // Extract schedule
        let schedule = 'Daily at 9:00 AM';
        if (lowerText.includes('daily')) {
          const timeMatch = text.match(/(\d{1,2}):?(\d{2})?\s*(am|pm)/i);
          schedule = timeMatch ? `Daily at ${timeMatch[0]}` : 'Daily at 9:00 AM';
        } else if (lowerText.includes('weekly')) {
          schedule = 'Weekly on Monday';
        } else if (lowerText.includes('hourly') || lowerText.includes('every') && lowerText.includes('hour')) {
          schedule = 'Hourly';
        }

        return {
          name: extractName(text) || 'New Automation',
          trigger: trigger,
          triggerDetails: triggerDetails,
          actions: actions.length > 0 ? actions : ['Send Campaign'],
          schedule: schedule,
          description: text
        };
      };

      const parseConversation = (conv) => {
        const data = {};
        conv.forEach(item => {
          data[item.key] = item.answer;
        });

        return parseNaturalLanguage(
          `${data.trigger || ''} -> ${data.actions || ''} -> ${data.schedule || ''}`
        );
      };

      const extractName = (text) => {
        // Try to extract a meaningful name
        if (text.includes('renewal')) return 'Renewal Reminder';
        if (text.includes('follow-up') || text.includes('followup')) return 'Follow-Up Automation';
        if (text.includes('alert')) return 'Alert Automation';
        return null;
      };

      const handleConfirm = () => {
        if (parsedAutomation) {
          const template = {
            id: 'nl-generated',
            name: parsedAutomation.name,
            description: parsedAutomation.description,
            isInsights: parsedAutomation.trigger === 'anomaly' || parsedAutomation.trigger === 'predictive',
            triggerType: parsedAutomation.trigger,
            ...parsedAutomation
          };
          onComplete(template);
        }
      };

      // Extract workflow data from conversation/input for visual display
      const getWorkflowData = () => {
        if (parsedAutomation) {
          return {
            trigger: parsedAutomation.triggerDetails?.condition || parsedAutomation.trigger || 'Trigger',
            triggerEntity: parsedAutomation.triggerDetails?.entity || 'Data',
            actions: parsedAutomation.actions || [],
            schedule: parsedAutomation.schedule || 'Schedule'
          };
        }

        // Build from conversation
        const workflowData = {
          trigger: null,
          triggerEntity: null,
          actions: [],
          schedule: null
        };

        conversation.forEach(item => {
          if (item.key === 'trigger') {
            workflowData.trigger = item.answer;
            // Try to extract entity from trigger answer
            const triggerLower = item.answer.toLowerCase();
            if (triggerLower.includes('policy') || triggerLower.includes('policies')) {
              workflowData.triggerEntity = 'Policies';
            } else if (triggerLower.includes('client') || triggerLower.includes('clients')) {
              workflowData.triggerEntity = 'Clients';
            } else if (triggerLower.includes('quote') || triggerLower.includes('quotes')) {
              workflowData.triggerEntity = 'Quotes';
            } else if (triggerLower.includes('activity') || triggerLower.includes('activities')) {
              workflowData.triggerEntity = 'Activities';
            }
          } else if (item.key === 'actions') {
            // Parse actions from answer
            const answer = item.answer.toLowerCase();
            if (answer.includes('campaign') || answer.includes('email') || answer.includes('send')) {
              workflowData.actions.push({ type: 'campaign', title: 'Send Campaign' });
            }
            if (answer.includes('activity') || answer.includes('task') || answer.includes('create')) {
              workflowData.actions.push({ type: 'activity', title: 'Create Activity' });
            }
            if (answer.includes('notification') || answer.includes('alert') || answer.includes('notify')) {
              workflowData.actions.push({ type: 'notification', title: 'Send Notification' });
            }
            if (answer.includes('submission')) {
              workflowData.actions.push({ type: 'submission', title: 'Create Submission' });
            }
            if (answer.includes('quote')) {
              workflowData.actions.push({ type: 'quote', title: 'Generate Quote' });
            }
            if (answer.includes('proposal')) {
              workflowData.actions.push({ type: 'proposal', title: 'Build Proposal' });
            }
            // If no actions detected, add a placeholder
            if (workflowData.actions.length === 0) {
              workflowData.actions.push({ type: 'campaign', title: 'Action' });
            }
          } else if (item.key === 'schedule') {
            workflowData.schedule = item.answer;
          }
        });

        return workflowData;
      };

      const workflowData = getWorkflowData();

      return (
        <div className="max-w-7xl mx-auto space-y-6">
          <div>
            <button onClick={onBack} className="text-blue-600 hover:text-blue-700 mb-4 flex items-center gap-2">
              ‚Üê Back to Trigger Selection
            </button>
            <h1 className="text-3xl font-bold text-gray-900 mb-2">Create Automation with Natural Language</h1>
            <p className="text-gray-600">Describe what you want in plain English, and we'll build it for you</p>
          </div>

          {/* Two Column Layout */}
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
            {/* Left Column - Input */}
            <div className="space-y-6">
              {/* Mode Selection */}
              <div className="bg-white rounded-lg border border-gray-200 p-6">
                <div className="flex items-center gap-4 mb-4">
                  <span className="text-sm font-medium text-gray-700">Input Mode:</span>
                  <button
                    onClick={() => {
                      setMode('direct');
                      setInput('');
                      setParsedAutomation(null);
                    }}
                    className={`px-4 py-2 rounded-lg font-medium transition-colors ${mode === 'direct'
                      ? 'bg-blue-600 text-white'
                      : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                      }`}
                  >
                    Direct Input
                  </button>
                  <button
                    onClick={() => {
                      setMode('conversational');
                      setConversation([]);
                      setCurrentQuestion(null);
                      setParsedAutomation(null);
                    }}
                    className={`px-4 py-2 rounded-lg font-medium transition-colors ${mode === 'conversational'
                      ? 'bg-blue-600 text-white'
                      : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                      }`}
                  >
                    Guided Questions
                  </button>
                </div>

                {/* Direct Input Mode */}
                {mode === 'direct' && (
                  <div className="space-y-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        Describe your automation (trigger ‚Üí actions ‚Üí schedule)
                      </label>
                      <textarea
                        value={input}
                        onChange={(e) => setInput(e.target.value)}
                        placeholder="Example: Send renewal reminders to policies expiring in 60 days, daily at 9 AM"
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[120px]"
                        rows={4}
                      />
                      <div className="mt-2 text-xs text-gray-500">
                        üí° Tip: Include what triggers it, what actions to take, and when it should run
                      </div>
                    </div>
                    <button
                      onClick={handleDirectSubmit}
                      disabled={!input.trim() || isProcessing}
                      className="w-full px-6 py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"
                    >
                      {isProcessing ? (
                        <>
                          <div className="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                          Processing...
                        </>
                      ) : (
                        <>
                          <Brain size={20} />
                          Generate Automation
                        </>
                      )}
                    </button>
                  </div>
                )}

                {/* Conversational Mode */}
                {mode === 'conversational' && (
                  <div className="space-y-4">
                    {!currentQuestion && conversation.length === 0 && (
                      <div className="text-center py-8">
                        <div className="text-4xl mb-4">üí¨</div>
                        <p className="text-gray-600 mb-4">We'll ask you a few questions to understand what you need</p>
                        <button
                          onClick={handleConversationalStart}
                          className="px-6 py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700"
                        >
                          Start Questions
                        </button>
                      </div>
                    )}

                    {currentQuestion && (
                      <div className="space-y-4">
                        {/* Conversation History */}
                        {conversation.length > 0 && (
                          <div className="space-y-3 max-h-64 overflow-y-auto">
                            {conversation.map((item, idx) => (
                              <div key={idx} className="space-y-2">
                                <div className="bg-blue-50 border border-blue-200 rounded-lg p-3">
                                  <div className="text-xs font-medium text-blue-900 mb-1">Question:</div>
                                  <div className="text-sm text-blue-800">{item.question}</div>
                                </div>
                                <div className="bg-gray-50 border border-gray-200 rounded-lg p-3 ml-4">
                                  <div className="text-xs font-medium text-gray-700 mb-1">Your Answer:</div>
                                  <div className="text-sm text-gray-900">{item.answer}</div>
                                </div>
                              </div>
                            ))}
                          </div>
                        )}

                        {/* Current Question */}
                        <div className="bg-purple-50 border border-purple-200 rounded-lg p-4">
                          <div className="text-sm font-medium text-purple-900 mb-2">
                            Question {conversation.length + 1} of {questionFlow.length}
                          </div>
                          <div className="text-lg font-bold text-gray-900 mb-4">{currentQuestion.question}</div>
                          <div className="flex gap-2">
                            <input
                              type="text"
                              onKeyPress={(e) => {
                                if (e.key === 'Enter' && e.target.value.trim()) {
                                  handleConversationalAnswer(e.target.value);
                                  e.target.value = '';
                                }
                              }}
                              placeholder="Type your answer..."
                              className="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"
                            />
                            <button
                              onClick={(e) => {
                                const input = e.target.previousElementSibling;
                                if (input.value.trim()) {
                                  handleConversationalAnswer(input.value);
                                  input.value = '';
                                }
                              }}
                              className="px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700"
                            >
                              Submit
                            </button>
                          </div>
                        </div>
                      </div>
                    )}

                    {isProcessing && (
                      <div className="text-center py-8">
                        <div className="w-8 h-8 border-4 border-purple-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
                        <p className="text-gray-600">Analyzing your responses and generating automation...</p>
                      </div>
                    )}
                  </div>
                )}

                {/* Parsed Result Preview */}
                {parsedAutomation && !isProcessing && (
                  <div className="bg-green-50 border-2 border-green-300 rounded-lg p-6">
                    <div className="flex items-start gap-3 mb-4">
                      <Check className="text-green-600 mt-0.5" size={24} />
                      <div className="flex-1">
                        <h3 className="text-lg font-bold text-gray-900 mb-2">Automation Generated!</h3>
                        <p className="text-sm text-gray-700 mb-4">Review the details and confirm to proceed to configuration.</p>
                      </div>
                    </div>

                    <div className="bg-white rounded-lg p-4 space-y-3 mb-4">
                      <div>
                        <div className="text-xs font-medium text-gray-500 mb-1">Name</div>
                        <div className="text-sm font-medium text-gray-900">{parsedAutomation.name}</div>
                      </div>
                      <div>
                        <div className="text-xs font-medium text-gray-500 mb-1">Trigger</div>
                        <div className="text-sm text-gray-900">
                          {parsedAutomation.triggerDetails.entity || parsedAutomation.trigger}: {parsedAutomation.triggerDetails.condition || 'Scheduled'}
                        </div>
                      </div>
                      <div>
                        <div className="text-xs font-medium text-gray-500 mb-1">Actions</div>
                        <div className="flex gap-2 flex-wrap">
                          {parsedAutomation.actions.map((action, idx) => (
                            <span key={idx} className="px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs font-medium">
                              {action}
                            </span>
                          ))}
                        </div>
                      </div>
                      <div>
                        <div className="text-xs font-medium text-gray-500 mb-1">Schedule</div>
                        <div className="text-sm text-gray-900">{parsedAutomation.schedule}</div>
                      </div>
                    </div>

                    <div className="flex gap-3">
                      <button
                        onClick={() => {
                          setParsedAutomation(null);
                          setInput('');
                          setConversation([]);
                          setCurrentQuestion(null);
                        }}
                        className="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50"
                      >
                        Start Over
                      </button>
                      <button
                        onClick={handleConfirm}
                        className="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 flex items-center justify-center gap-2"
                      >
                        <Check size={20} />
                        Confirm & Configure
                      </button>
                    </div>
                  </div>
                )}
              </div>
            </div>


            {/* Right Column - Visual Workflow */}
            <div className="bg-white border border-gray-200 rounded-lg p-6">
              <h3 className="text-lg font-bold text-gray-900 mb-4">Workflow Preview</h3>
              <NaturalLanguageFlowView workflowData={workflowData} conversation={conversation} currentQuestion={currentQuestion} />
            </div>
          </div>
        </div >
      );

    }
    // Natural Language Flow View Component
    function NaturalLanguageFlowView({ workflowData, conversation, currentQuestion }) {

      const actionConfig = {
        campaign: { icon: 'üìß', bgColor: 'bg-blue-100', borderColor: 'border-blue-500', title: 'Send Campaign' },
        activity: { icon: 'üìã', bgColor: 'bg-purple-100', borderColor: 'border-purple-500', title: 'Create Activity' },
        notification: { icon: 'üîî', bgColor: 'bg-yellow-100', borderColor: 'border-yellow-500', title: 'Send Notification' },
        submission: { icon: 'üìÑ', bgColor: 'bg-indigo-100', borderColor: 'border-indigo-500', title: 'Create Submission' },
        quote: { icon: 'üí∞', bgColor: 'bg-green-100', borderColor: 'border-green-500', title: 'Generate Quote' },
        proposal: { icon: 'üìä', bgColor: 'bg-orange-100', borderColor: 'border-orange-500', title: 'Build Proposal' }
      };

      const hasTrigger = workflowData.trigger || conversation.some(c => c.key === 'trigger');
      const hasActions = workflowData.actions.length > 0 || conversation.some(c => c.key === 'actions');
      const hasSchedule = workflowData.schedule || conversation.some(c => c.key === 'schedule');

      return (
        <div className="space-y-4">
          {/* Trigger */}
          <div className="flex items-center justify-center">
            <div className={`rounded-lg p-4 text-center min-w-[200px] border-2 ${hasTrigger
              ? 'bg-green-100 border-green-500'
              : currentQuestion?.key === 'trigger'
                ? 'bg-yellow-100 border-yellow-400 animate-pulse'
                : 'bg-gray-100 border-gray-300'
              }`}>
              <div className="text-2xl mb-2">üéØ</div>
              <div className="font-bold text-gray-900 text-sm">Trigger</div>
              {hasTrigger ? (
                <div className="text-xs text-gray-600 mt-1 break-words">
                  {workflowData.triggerEntity && (
                    <div className="font-medium mb-1">{workflowData.triggerEntity}</div>
                  )}
                  {workflowData.trigger || conversation.find(c => c.key === 'trigger')?.answer || 'Defined'}
                </div>
              ) : (
                <div className="text-xs text-gray-500 mt-1">
                  {currentQuestion?.key === 'trigger' ? 'Answering...' : 'Not defined'}
                </div>
              )}
            </div>
          </div>

          {/* Arrow */}
          {(hasTrigger || hasActions) && (
            <div className="flex justify-center">
              <div className={`w-1 h-8 ${hasTrigger ? 'bg-gray-400' : 'bg-gray-200'}`}></div>
            </div>
          )}

          {/* Actions */}
          {workflowData.actions.length > 0 ? (
            workflowData.actions.map((action, index) => {
              const config = actionConfig[action.type] || { icon: '‚öôÔ∏è', bgColor: 'bg-gray-100', borderColor: 'border-gray-500', title: action.title || action };
              return (
                <React.Fragment key={index}>
                  <div className="flex items-center justify-center">
                    <div className={`${config.bgColor} border-2 ${config.borderColor} rounded-lg p-3 text-center min-w-[200px]`}>
                      <div className="text-xl mb-1">{config.icon}</div>
                      <div className="font-bold text-gray-900 text-xs">{config.title}</div>
                      <div className="text-xs text-gray-600 mt-1">Action {index + 1}</div>
                    </div>
                  </div>
                  {index < workflowData.actions.length - 1 && (
                    <div className="flex justify-center">
                      <div className="w-1 h-6 bg-gray-400"></div>
                    </div>
                  )}
                </React.Fragment>
              );
            })
          ) : (
            <>
              {hasTrigger && (
                <div className="flex items-center justify-center">
                  <div className={`rounded-lg p-4 text-center min-w-[200px] border-2 ${currentQuestion?.key === 'actions'
                    ? 'bg-yellow-100 border-yellow-400 animate-pulse'
                    : 'bg-gray-100 border-gray-300'
                    }`}>
                    <div className="text-2xl mb-2">‚öôÔ∏è</div>
                    <div className="font-bold text-gray-900 text-sm">Actions</div>
                    <div className="text-xs text-gray-500 mt-1">
                      {currentQuestion?.key === 'actions' ? 'Answering...' : 'Not defined'}
                    </div>
                  </div>
                </div>
              )}
            </>
          )}

          {/* Schedule Arrow */}
          {(hasActions || hasTrigger) && (hasSchedule || currentQuestion?.key === 'schedule') && (
            <div className="flex justify-center">
              <div className={`w-1 h-8 ${hasActions ? 'bg-gray-400' : 'bg-gray-200'}`}></div>
            </div>
          )}

          {/* Schedule */}
          {(hasSchedule || currentQuestion?.key === 'schedule') && (
            <>
              <div className="flex items-center justify-center">
                <div className={`rounded-lg p-4 text-center min-w-[200px] border-2 ${hasSchedule
                  ? 'bg-blue-100 border-blue-500'
                  : 'bg-yellow-100 border-yellow-400 animate-pulse'
                  }`}>
                  <div className="text-2xl mb-2">üìÖ</div>
                  <div className="font-bold text-gray-900 text-sm">Schedule</div>
                  {hasSchedule ? (
                    <div className="text-xs text-gray-600 mt-1 break-words">
                      {workflowData.schedule || conversation.find(c => c.key === 'schedule')?.answer || 'Defined'}
                    </div>
                  ) : (
                    <div className="text-xs text-gray-500 mt-1">Answering...</div>
                  )}
                </div>
              </div>
              <div className="flex justify-center">
                <div className="w-1 h-8 bg-gray-400"></div>
              </div>
            </>
          )}

          {/* Complete */}
          {hasTrigger && hasActions && hasSchedule && (
            <div className="flex items-center justify-center">
              <div className="bg-gray-100 border-2 border-gray-400 rounded-lg p-4 text-center min-w-[200px]">
                <div className="text-2xl mb-2">‚úì</div>
                <div className="font-bold text-gray-900 text-sm">Complete</div>
              </div>
            </div>
          )}

          {/* Empty State */}
          {!hasTrigger && !currentQuestion && (
            <div className="text-center py-8 text-gray-400">
              <div className="text-3xl mb-2">üìã</div>
              <div className="text-sm">Start answering questions to see your workflow</div>
            </div>
          )}
        </div>
      );
    }

    function TemplatesView({ onSelectTemplate }) {
      const [selectedCategory, setSelectedCategory] = useState('all');

      const categories = ['all', 'Insights & Analytics', 'Policy Lifecycle', 'Client Engagement', 'Sales Process', 'Advanced Workflows', 'Looker-Powered', 'Risk Management', 'Data Quality'];

      const filteredTemplates = selectedCategory === 'all'
        ? templates
        : templates.filter(t => t.category === selectedCategory);

      return (
        <div className="space-y-6">
          <div>
            <h2 className="text-xl font-bold text-gray-900 mb-2">Choose a Starting Point</h2>
            <p className="text-gray-600">Select a template or build from scratch</p>
          </div>

          {/* Category Filter */}
          <div className="flex gap-2 flex-wrap">
            {categories.map(category => (
              <button
                key={category}
                onClick={() => setSelectedCategory(category)}
                className={`px-4 py-2 rounded-lg font-medium transition-colors ${selectedCategory === category
                  ? 'bg-blue-600 text-white'
                  : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'
                  }`}
              >
                {category === 'all' ? 'All Templates' : category}
                {category === 'Advanced Workflows' && <span className="ml-2 text-xs">‚ú®</span>}
                {category === 'Looker-Powered' && <span className="ml-2 text-xs">üìä</span>}
              </button>
            ))}
          </div>

          {/* Advanced Workflows Info Banner */}
          {selectedCategory === 'Advanced Workflows' && (
            <div className="bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-lg p-4">
              <div className="flex items-start gap-3">
                <span className="text-2xl">‚ö°</span>
                <div>
                  <h3 className="font-bold text-gray-900 mb-1">Advanced Multi-Step Workflows</h3>
                  <p className="text-sm text-gray-700">
                    These templates chain multiple actions together to automate complete business processes.
                    Perfect for submission-to-bind pipelines, renewal workflows, and complex sales processes.
                  </p>
                </div>
              </div>
            </div>
          )}

          {/* Looker-Powered Info Banner */}
          {selectedCategory === 'Looker-Powered' && (
            <div className="bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-lg p-4">
              <div className="flex items-start gap-3">
                <span className="text-2xl">üìä</span>
                <div>
                  <h3 className="font-bold text-gray-900 mb-1">Powered by Your Looker Semantic Model</h3>
                  <p className="text-sm text-gray-700">
                    These templates use pre-built Looker Looks from your semantic model, ensuring data consistency
                    and leveraging the queries your analytics team has already validated and optimized.
                  </p>
                </div>
              </div>
            </div>
          )}

          <div className="flex gap-4 grid grid-cols-2 items-center justify-between">
            {/* Natural Language Option */}
            <div
              onClick={() => onSelectTemplate({ id: 'natural-language', name: 'Natural Language', description: '', category: 'Natural Language', icon: '‚ú®', popularity: 0, isNaturalLanguage: true })}
              className="bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6 rounded-xl cursor-pointer hover:shadow-lg transition-shadow border-2 border-purple-400"
            >
              <div className="flex items-center justify-between">
                <div>
                  <div className="flex items-center gap-2 mb-2">
                    <h3 className="text-xl font-bold">Try our new natural language-based creation</h3>
                    <span className="px-2 py-1 bg-white text-purple-600 text-xs font-bold rounded">NEW</span>
                  </div>
                  <p className="text-purple-100">Describe your automation in plain English - we'll build it for you</p>
                </div>
                <ChevronRight size={32} />
              </div>
            </div>

            {/* Custom Build Option */}
            <div
              onClick={() => onSelectTemplate({ id: 'custom', name: 'Custom Automation', description: '', category: 'Custom', icon: 'üîß', popularity: 0 })}
              className="bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 rounded-xl cursor-pointer hover:shadow-lg transition-shadow"
            >
              <div className="flex items-center justify-between">
                <div>
                  <h3 className="text-xl font-bold mb-2">Build from Scratch</h3>
                  <p className="text-blue-100">Full control over every detail of your automation</p>
                </div>
                <ChevronRight size={32} />
              </div>
            </div>
          </div>

          {/* Template Grid */}
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {filteredTemplates.map(template => (
              <TemplateCard
                key={template.id}
                template={template}
                onClick={() => onSelectTemplate(template)}
              />
            ))}
          </div>
        </div>
      );
    }

    // Builder View
    function BuilderView({ template, onBack }) {
      const [step, setStep] = useState(1);

      // Pre-populate advanced workflow templates with chained actions
      const getInitialActions = () => {
        if (template?.id === 't7') {
          // Automated Quote-to-Bind Workflow
          return [
            { id: 1, type: 'submission', expanded: false },
            { id: 2, type: 'wait', expanded: false },
            { id: 3, type: 'quote', expanded: false },
            { id: 4, type: 'wait', expanded: false },
            { id: 5, type: 'proposal', expanded: false },
            { id: 6, type: 'campaign', expanded: false },
            { id: 7, type: 'activity', expanded: false }
          ];
        } else if (template?.id === 't8') {
          // Renewal Quote Pipeline
          return [
            { id: 1, type: 'submission', expanded: false },
            { id: 2, type: 'quote', expanded: false },
            { id: 3, type: 'wait', expanded: false },
            { id: 4, type: 'proposal', expanded: false },
            { id: 5, type: 'notification', expanded: false }
          ];
        } else if (template?.id === 't9') {
          // Lead to Bound Policy
          return [
            { id: 1, type: 'submission', expanded: false },
            { id: 2, type: 'activity', expanded: false },
            { id: 3, type: 'quote', expanded: false },
            { id: 4, type: 'proposal', expanded: false },
            { id: 5, type: 'campaign', expanded: false },
            { id: 6, type: 'wait', expanded: false },
            { id: 7, type: 'condition', expanded: false },
            { id: 8, type: 'notification', expanded: false }
          ];
        } else if (template?.id === 't10') {
          // Comparative Quote Workflow
          return [
            { id: 1, type: 'submission', expanded: false },
            { id: 2, type: 'quote', expanded: false },
            { id: 3, type: 'wait', expanded: false },
            { id: 4, type: 'proposal', expanded: false },
            { id: 5, type: 'notification', expanded: false },
            { id: 6, type: 'activity', expanded: false }
          ];
        } else {
          return [
            { id: 1, type: 'campaign', expanded: true },
            { id: 2, type: 'activity', expanded: true }
          ];
        }
      };

      const [automationData, setAutomationData] = useState({
        name: template?.name || '',
        entity: 'policies',
        filters: [{ field: 'expirationDate', operator: 'inNext', value: '60', unit: 'days' }],
        conditions: [{ field: 'premium', operator: 'greaterThan', value: '5000' }],
        actions: getInitialActions(),
        schedule: 'daily'
      });

      return (
        <div className="max-w-5xl mx-auto">
          {/* Progress Steps */}
          <div className="mb-8">
            <button onClick={onBack} className="text-blue-600 hover:text-blue-700 mb-4 flex items-center gap-2">
              ‚Üê Back to Dashboard
            </button>

            {template?.isInsights && (
              <div className="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4">
                <div className="flex items-center gap-2">
                  <Brain size={24} className="text-purple-600" />
                  <div>
                    <h3 className="font-bold text-purple-900">Insights-Powered Automation</h3>
                    <p className="text-sm text-purple-700">
                      This automation uses AI and machine learning to detect patterns and trigger actions intelligently.
                    </p>
                  </div>
                </div>
              </div>
            )}

            {template?.isAdvanced && !template?.isInsights && (
              <div className="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4">
                <div className="flex items-center gap-2">
                  <span className="text-2xl">‚ö°</span>
                  <div>
                    <h3 className="font-bold text-purple-900">Advanced Workflow Template</h3>
                    <p className="text-sm text-purple-700">
                      This template includes pre-configured action chains. Review and customize each step.
                    </p>
                  </div>
                </div>
              </div>
            )}

            <div className="flex items-center justify-between">
              {(template?.isInsights ? [
                { num: 1, label: 'Trigger Setup' },
                { num: 2, label: 'Conditions' },
                { num: 3, label: 'Actions' },
                { num: 4, label: 'Schedule' }
              ] : [
                { num: 1, label: 'Query' },
                { num: 2, label: 'Conditions' },
                { num: 3, label: 'Actions' },
                { num: 4, label: 'Schedule' }
              ]).map((s, idx) => (
                <React.Fragment key={s.num}>
                  <div className="flex items-center">
                    <div className={`w-10 h-10 rounded-full flex items-center justify-center font-bold ${step >= s.num ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-600'
                      }`}>
                      {s.num}
                    </div>
                    <span className={`ml-3 font-medium ${step >= s.num ? 'text-gray-900' : 'text-gray-500'}`}>
                      {s.label}
                    </span>
                  </div>
                  {idx < 3 && (
                    <div className={`flex-1 h-1 mx-4 ${step > s.num ? 'bg-blue-600' : 'bg-gray-200'}`} />
                  )}
                </React.Fragment>
              ))}
            </div>
          </div>

          {/* Builder Content */}
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-8">
            {template?.isInsights ? (
              <>
                {step === 1 && <InsightsTriggerBuilder template={template} data={automationData} onChange={setAutomationData} />}
                {step === 2 && <ConditionsBuilder data={automationData} onChange={setAutomationData} />}
                {step === 3 && <ActionsBuilder data={automationData} onChange={setAutomationData} />}
                {step === 4 && <ScheduleBuilder data={automationData} onChange={setAutomationData} />}
              </>
            ) : (
              <>
                {step === 1 && <QueryBuilder data={automationData} onChange={setAutomationData} />}
                {step === 2 && <ConditionsBuilder data={automationData} onChange={setAutomationData} />}
                {step === 3 && <ActionsBuilder data={automationData} onChange={setAutomationData} />}
                {step === 4 && <ScheduleBuilder data={automationData} onChange={setAutomationData} />}
              </>
            )}

            {/* Navigation */}
            <div className="flex justify-between mt-8 pt-6 border-t border-gray-200">
              <button
                onClick={() => setStep(Math.max(1, step - 1))}
                disabled={step === 1}
                className="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
              >
                Previous
              </button>
              <button
                onClick={() => {
                  if (step === 4) {
                    alert('Automation saved and activated!');
                    onBack();
                  } else {
                    setStep(Math.min(4, step + 1));
                  }
                }}
                className="px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700"
              >
                {step === 4 ? 'Save & Activate' : 'Next'}
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Insights Trigger Builder Component
    function InsightsTriggerBuilder({ template, data, onChange }) {
      const triggerConfig = {
        anomaly: {
          title: 'Anomaly Detection',
          description: 'Detect when metrics deviate significantly from historical patterns using statistical analysis',
          icon: 'üö®',
          color: 'red',
          fields: [
            { label: 'Metric to Monitor', type: 'select', options: ['Cancellation Rate', 'Revenue', 'Quote Volume', 'Customer Count', 'Policy Count', 'Average Premium'] },
            { label: 'Detection Method', type: 'select', options: ['Standard Deviation (2œÉ)', 'Standard Deviation (3œÉ)', 'Interquartile Range (IQR)', 'Z-Score'] },
            { label: 'Baseline Period', type: 'select', options: ['Last 7 days', 'Last 30 days', 'Last 90 days', 'Last 365 days'] },
            { label: 'Check Frequency', type: 'select', options: ['Every 5 minutes', 'Every 15 minutes', 'Hourly', 'Every 6 hours', 'Daily'] }
          ]
        },
        predictive: {
          title: 'Predictive Forecast',
          description: 'Forecast future trends using machine learning and alert before targets are missed',
          icon: 'üîÆ',
          color: 'purple',
          fields: [
            { label: 'Metric to Forecast', type: 'select', options: ['Client Retention Rate', 'Policy Churn Risk', 'Renewal Rate', 'Policy Lapse Probability', 'Client Lifetime Value', 'Quote Conversion Rate'] },
            { label: 'Forecast Horizon', type: 'select', options: ['Next 7 days', 'Next 14 days', 'Next 30 days', 'End of Month', 'End of Quarter'] },
            { label: 'Alert When Below', type: 'number', placeholder: '% of target (e.g., 95)' },
            { label: 'Model Type', type: 'select', options: ['Time Series (ARIMA)', 'ML Regression', 'Simple Moving Average', 'Exponential Smoothing'] }
          ]
        },
        threshold: {
          title: 'Threshold Monitor',
          description: 'Alert when metrics cross defined thresholds',
          icon: '‚ö†Ô∏è',
          color: 'yellow',
          fields: [
            { label: 'Metric to Monitor', type: 'select', options: ['Activities Past Expiration', 'Activities Per Employee', 'Overdue Follow-ups Count', 'Pending Quotes Per Producer', 'Unresolved Claims Count', 'Data Quality Score'] },
            { label: 'Condition', type: 'select', options: ['Falls below', 'Exceeds', 'Equals', 'Changes by more than'] },
            { label: 'Threshold Value', type: 'number', placeholder: 'Enter numeric value' },
            { label: 'Check Frequency', type: 'select', options: ['Every 5 minutes', 'Every 15 minutes', 'Hourly', 'Every 6 hours', 'Daily'] }
          ]
        },
        trend: {
          title: 'Trend Analysis',
          description: 'Monitor trends over time and alert on concerning directional patterns',
          icon: 'üìà',
          color: 'blue',
          fields: [
            { label: 'Metric to Analyze', type: 'select', options: ['Renewal Rate', 'Customer Acquisition', 'Average Premium', 'Quote Volume', 'Conversion Rate'] },
            { label: 'Trend Window', type: 'select', options: ['7-day rolling', '14-day rolling', '30-day rolling', '90-day rolling'] },
            { label: 'Alert Condition', type: 'select', options: ['Declining trend > 5%', 'Declining trend > 10%', 'Declining trend > 15%', 'Any negative trend'] },
            { label: 'Check Frequency', type: 'select', options: ['Daily', 'Every 3 days', 'Weekly', 'Bi-weekly'] }
          ]
        },
        pattern: {
          title: 'Pattern Recognition',
          description: 'Detect recurring patterns or unexpected behaviors using AI',
          icon: 'üîç',
          color: 'indigo',
          fields: [
            { label: 'Pattern Type', type: 'select', options: ['Duplicate Records', 'Unusual Sequences', 'Cyclical Patterns', 'Anomalous Clusters'] },
            { label: 'Detection Sensitivity', type: 'select', options: ['Low (fewer false positives)', 'Medium (balanced)', 'High (catch more issues)'] },
            { label: 'Minimum Confidence', type: 'number', placeholder: '% confidence threshold (e.g., 80)' },
            { label: 'Check Frequency', type: 'select', options: ['Every 15 minutes', 'Hourly', 'Every 6 hours', 'Daily'] }
          ]
        },
        comparative: {
          title: 'Comparative Analysis',
          description: 'Compare performance across entities and identify statistical outliers',
          icon: 'üèÜ',
          color: 'green',
          fields: [
            { label: 'Compare Across', type: 'select', options: ['Offices', 'Teams', 'Producers', 'Regions', 'Product Lines'] },
            { label: 'Metric to Compare', type: 'select', options: ['Revenue', 'Policy Count', 'Retention Rate', 'Quote Conversion', 'Customer Satisfaction'] },
            { label: 'Alert Condition', type: 'select', options: ['Below average by >10%', 'Below average by >20%', 'In bottom 25%', 'In bottom 10%'] },
            { label: 'Check Frequency', type: 'select', options: ['Daily', 'Every 3 days', 'Weekly', 'Monthly'] }
          ]
        },
        composite: {
          title: 'Multi-Factor Analysis',
          description: 'Combine multiple indicators for sophisticated composite scoring and risk detection. Example: Activities past expiration + Increased quote timeframe = Churn risk',
          icon: 'üéØ',
          color: 'pink',
          fields: [
            { label: 'Primary Factor', type: 'select', options: ['Churn Risk Score', 'Client Health Score', 'Retention Risk Score', 'Engagement Score', 'Compliance Risk Score'] },
            { label: 'Number of Secondary Factors', type: 'select', options: ['2 factors', '3 factors', '4 factors', '5+ factors'] },
            { label: 'Weighting Method', type: 'select', options: ['Equal weights', 'ML-based weights', 'Custom weights', 'Priority-based'] },
            { label: 'Alert Threshold', type: 'number', placeholder: 'Combined score threshold (e.g., 75)' }
          ]
        }
      };

      const config = triggerConfig[template.triggerType] || triggerConfig.threshold;

      return (
        <div className="space-y-6">
          <div className={`bg-${config.color}-50 border border-${config.color}-200 rounded-lg p-6`}>
            <div className="flex items-start gap-4">
              <div className="text-5xl">{config.icon}</div>
              <div className="flex-1">
                <h2 className="text-2xl font-bold text-gray-900 mb-2">{config.title}</h2>
                <p className="text-gray-600">{config.description}</p>
              </div>
            </div>
          </div>

          <div className="space-y-4">
            {config.fields.map((field, idx) => (
              <div key={idx}>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  {field.label}
                </label>
                {field.type === 'select' && (
                  <select className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                    <option value="">Select {field.label.toLowerCase()}...</option>
                    {field.options.map(opt => (
                      <option key={opt} value={opt}>{opt}</option>
                    ))}
                  </select>
                )}
                {field.type === 'number' && (
                  <input
                    type="number"
                    placeholder={field.placeholder}
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                  />
                )}
              </div>
            ))}
          </div>

          <div className="bg-purple-50 border border-purple-200 rounded-lg p-4">
            <div className="flex items-start gap-3">
              <Target size={20} className="text-purple-600 mt-0.5" />
              <div>
                <h4 className="font-medium text-purple-900 mb-2">Expected Accuracy</h4>
                <div className="space-y-2">
                  <div className="flex items-center justify-between text-sm">
                    <span className="text-purple-800">Estimated trigger rate:</span>
                    <span className="font-bold text-purple-900">5-15% of checks</span>
                  </div>
                  <div className="flex items-center justify-between text-sm">
                    <span className="text-purple-800">Typical accuracy:</span>
                    <span className="font-bold text-purple-900">85-95%</span>
                  </div>
                  <p className="text-xs text-purple-700 mt-2">
                    Performance improves as the system learns from your feedback on triggered alerts.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    }

    // Query Builder Component
    function QueryBuilder({ data, onChange }) {
      const [querySource, setQuerySource] = useState('builder'); // 'builder' or 'looker'
      const [selectedLook, setSelectedLook] = useState(null);

      // Sample Looker Looks from the semantic model
      const lookerLooks = [
        {
          id: 'look_1',
          name: 'Policies Expiring Next 60 Days',
          description: 'All active policies with expiration dates in the next 60 days',
          category: 'Policy Lifecycle',
          fields: ['policy_number', 'client_name', 'expiration_date', 'premium', 'csr_name'],
          recordCount: 247,
          lastUpdated: '2 hours ago'
        },
        {
          id: 'look_2',
          name: 'High Value Clients (>$10K Premium)',
          description: 'Clients with total annual premium exceeding $10,000',
          category: 'Client Segmentation',
          fields: ['client_id', 'client_name', 'total_premium', 'policy_count', 'account_manager'],
          recordCount: 156,
          lastUpdated: '1 day ago'
        },
        {
          id: 'look_3',
          name: 'Outstanding Quotes (3+ Days)',
          description: 'Quotes created more than 3 days ago without follow-up activity',
          category: 'Sales Pipeline',
          fields: ['quote_id', 'client_name', 'quote_amount', 'days_outstanding', 'producer'],
          recordCount: 42,
          lastUpdated: '3 hours ago'
        },
        {
          id: 'look_4',
          name: 'Renewal Opportunities Without Activity',
          description: 'Renewals in next 90 days with no contact in last 30 days',
          category: 'Policy Lifecycle',
          fields: ['policy_number', 'client_name', 'expiration_date', 'last_contact_date', 'premium'],
          recordCount: 89,
          lastUpdated: '5 hours ago'
        },
        {
          id: 'look_5',
          name: 'Cross-Sell Candidates: Auto Only',
          description: 'Clients with auto insurance but no home policy, homeowner status = yes',
          category: 'Cross-Sell',
          fields: ['client_id', 'client_name', 'auto_premium', 'homeowner_status', 'csr'],
          recordCount: 124,
          lastUpdated: '1 day ago'
        },
        {
          id: 'look_6',
          name: 'Policies at Risk of Lapse',
          description: 'Policies with payment issues or cancellation notices',
          category: 'Retention',
          fields: ['policy_number', 'client_name', 'status', 'days_until_cancel', 'premium'],
          recordCount: 31,
          lastUpdated: '4 hours ago'
        },
        {
          id: 'look_7',
          name: 'New Policies Last 7 Days',
          description: 'Recently bound policies for onboarding workflows',
          category: 'Policy Lifecycle',
          fields: ['policy_number', 'client_name', 'effective_date', 'line_of_business', 'producer'],
          recordCount: 18,
          lastUpdated: '2 hours ago'
        },
        {
          id: 'look_8',
          name: 'Commercial Clients Without Workers Comp',
          description: 'Commercial clients with employees but no workers comp coverage',
          category: 'Cross-Sell',
          fields: ['client_id', 'client_name', 'employee_count', 'existing_lines', 'account_manager'],
          recordCount: 67,
          lastUpdated: '1 day ago'
        }
      ];

      const handleSourceChange = (source) => {
        setQuerySource(source);
        if (source === 'builder') {
          setSelectedLook(null);
        }
      };

      const handleLookSelection = (look) => {
        setSelectedLook(look);
        // Update the parent data with Looker source
        onChange({
          ...data,
          querySource: 'looker',
          lookId: look.id,
          lookName: look.name,
          estimatedRecords: look.recordCount
        });
      };

      return (
        <div className="space-y-6">
          <div>
            <h2 className="text-2xl font-bold text-gray-900 mb-2">What data should trigger this automation?</h2>
            <p className="text-gray-600">Choose between building a query or using existing Looker Looks</p>
          </div>

          {/* Source Selection */}
          <div className="grid grid-cols-2 gap-4">
            <button
              onClick={() => handleSourceChange('builder')}
              className={`p-6 rounded-lg border-2 transition-all text-left ${querySource === 'builder'
                ? 'border-blue-500 bg-blue-50'
                : 'border-gray-200 bg-white hover:border-gray-300'
                }`}
            >
              <div className="flex items-start gap-3">
                <div className={`text-3xl ${querySource === 'builder' ? 'opacity-100' : 'opacity-50'}`}>üîß</div>
                <div>
                  <h3 className="font-bold text-gray-900 mb-1">Query Builder</h3>
                  <p className="text-sm text-gray-600">Build custom filters and conditions</p>
                </div>
              </div>
            </button>

            <button
              onClick={() => handleSourceChange('looker')}
              className={`p-6 rounded-lg border-2 transition-all text-left ${querySource === 'looker'
                ? 'border-blue-500 bg-blue-50'
                : 'border-gray-200 bg-white hover:border-gray-300'
                }`}
            >
              <div className="flex items-start gap-3">
                <div className={`text-3xl ${querySource === 'looker' ? 'opacity-100' : 'opacity-50'}`}>üìä</div>
                <div>
                  <h3 className="font-bold text-gray-900 mb-1">Looker Look</h3>
                  <p className="text-sm text-gray-600">Use pre-built queries from semantic model</p>
                  <span className="inline-block mt-2 px-2 py-1 bg-purple-100 text-purple-800 text-xs font-bold rounded">
                    RECOMMENDED
                  </span>
                </div>
              </div>
            </button>
          </div>

          {querySource === 'looker' && (
            <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
              <div className="flex items-start gap-3">
                <span className="text-xl">üí°</span>
                <div className="text-sm">
                  <p className="font-medium text-blue-900 mb-1">Why use Looker Looks?</p>
                  <ul className="text-blue-800 space-y-1">
                    <li>‚Ä¢ Leverage your existing semantic model and trusted data definitions</li>
                    <li>‚Ä¢ Pre-validated queries maintained by your analytics team</li>
                    <li>‚Ä¢ Consistent data across automations and reports</li>
                    <li>‚Ä¢ Real-time record counts and field mapping</li>
                  </ul>
                </div>
              </div>
            </div>
          )}

          {/* Query Builder View */}
          {querySource === 'builder' && (
            <>
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">Entity</label>
                <select
                  value={data.entity}
                  onChange={(e) => onChange({ ...data, entity: e.target.value })}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                >
                  <option value="policies">Policies</option>
                  <option value="clients">Clients</option>
                  <option value="quotes">Quotes</option>
                  <option value="activities">Activities</option>
                </select>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-3">Filters</label>
                <div className="space-y-3">
                  {data.filters.map((filter, idx) => (
                    <div key={idx} className="flex items-center gap-3 p-4 bg-gray-50 rounded-lg">
                      <select className="flex-1 px-3 py-2 border border-gray-300 rounded-lg bg-white">
                        <option value="expirationDate">Expiration Date</option>
                        <option value="effectiveDate">Effective Date</option>
                        <option value="premium">Premium</option>
                        <option value="status">Status</option>
                      </select>
                      <select className="px-3 py-2 border border-gray-300 rounded-lg bg-white">
                        <option value="inNext">is in next</option>
                        <option value="equals">equals</option>
                        <option value="greaterThan">greater than</option>
                        <option value="lessThan">less than</option>
                      </select>
                      <input
                        type="text"
                        value={filter.value}
                        className="w-24 px-3 py-2 border border-gray-300 rounded-lg"
                      />
                      <select className="px-3 py-2 border border-gray-300 rounded-lg bg-white">
                        <option value="days">days</option>
                        <option value="weeks">weeks</option>
                        <option value="months">months</option>
                      </select>
                      <button className="text-red-600 hover:text-red-700 p-2">
                        <X size={20} />
                      </button>
                    </div>
                  ))}
                  <button className="text-blue-600 hover:text-blue-700 font-medium flex items-center gap-2">
                    <Plus size={20} />
                    Add filter
                  </button>
                </div>
              </div>

              <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
                <div className="flex items-start gap-3">
                  <Users className="text-blue-600 mt-0.5" size={20} />
                  <div>
                    <p className="font-medium text-blue-900">Preview: ~247 policies match these criteria</p>
                    <button className="text-blue-600 hover:text-blue-700 text-sm mt-1">View sample records ‚Üí</button>
                  </div>
                </div>
              </div>
            </>
          )}

          {/* Looker Look Selector */}
          {querySource === 'looker' && (
            <div className="space-y-4">
              <div className="flex items-center justify-between mb-2">
                <label className="block text-sm font-medium text-gray-700">Select a Look from your semantic model</label>
                <button className="text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1">
                  <Search size={16} />
                  Search Looks
                </button>
              </div>

              {/* Category Tabs */}
              <div className="flex gap-2 overflow-x-auto pb-2">
                {['All', 'Policy Lifecycle', 'Sales Pipeline', 'Client Segmentation', 'Cross-Sell', 'Retention'].map(category => (
                  <button
                    key={category}
                    className="px-3 py-1.5 text-sm rounded-lg whitespace-nowrap bg-white border border-gray-300 hover:bg-gray-50 text-gray-700"
                  >
                    {category}
                  </button>
                ))}
              </div>

              {/* Looks Grid */}
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4 max-h-[500px] overflow-y-auto">
                {lookerLooks.map(look => (
                  <LookerLookCard
                    key={look.id}
                    look={look}
                    isSelected={selectedLook?.id === look.id}
                    onSelect={() => handleLookSelection(look)}
                  />
                ))}
              </div>

              {/* Selected Look Details */}
              {selectedLook && (
                <div className="bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-lg p-6">
                  <div className="flex items-start justify-between mb-4">
                    <div>
                      <h3 className="font-bold text-gray-900 text-lg mb-1">{selectedLook.name}</h3>
                      <p className="text-sm text-gray-700">{selectedLook.description}</p>
                    </div>
                    <button
                      onClick={() => setSelectedLook(null)}
                      className="text-gray-400 hover:text-gray-600"
                    >
                      <X size={20} />
                    </button>
                  </div>

                  <div className="grid grid-cols-3 gap-4 mb-4">
                    <div className="bg-white rounded-lg p-3">
                      <div className="text-2xl font-bold text-gray-900">{selectedLook.recordCount}</div>
                      <div className="text-xs text-gray-600">Records</div>
                    </div>
                    <div className="bg-white rounded-lg p-3">
                      <div className="text-2xl font-bold text-gray-900">{selectedLook.fields.length}</div>
                      <div className="text-xs text-gray-600">Fields</div>
                    </div>
                    <div className="bg-white rounded-lg p-3">
                      <div className="text-sm font-medium text-gray-900">{selectedLook.lastUpdated}</div>
                      <div className="text-xs text-gray-600">Last Updated</div>
                    </div>
                  </div>

                  <div>
                    <h4 className="text-sm font-semibold text-gray-700 mb-2">Available Fields</h4>
                    <div className="flex flex-wrap gap-2">
                      {selectedLook.fields.map(field => (
                        <span key={field} className="px-3 py-1 bg-white border border-gray-300 rounded-full text-xs font-medium text-gray-700">
                          {field}
                        </span>
                      ))}
                    </div>
                    <p className="text-xs text-gray-600 mt-3">
                      üí° These fields can be used in actions for personalization (e.g., {'{{client_name}}'}, {'{{premium}}'})
                    </p>
                  </div>

                  <div className="mt-4 flex gap-3">
                    <button className="flex-1 px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50">
                      View in Looker ‚Üí
                    </button>
                    <button className="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700">
                      Preview Sample Data
                    </button>
                  </div>
                </div>
              )}
            </div>
          )}
        </div>
      );
    }

    // Looker Look Card Component
    function LookerLookCard({ look, isSelected, onSelect }) {
      return (
        <button
          onClick={onSelect}
          className={`p-4 rounded-lg border-2 transition-all text-left ${isSelected
            ? 'border-purple-500 bg-purple-50 shadow-md'
            : 'border-gray-200 bg-white hover:border-purple-300 hover:shadow-sm'
            }`}
        >
          <div className="flex items-start justify-between mb-2">
            <h3 className="font-bold text-gray-900 text-sm">{look.name}</h3>
            {isSelected && (
              <div className="bg-purple-600 text-white rounded-full p-1">
                <Check size={12} />
              </div>
            )}
          </div>
          <p className="text-xs text-gray-600 mb-3">{look.description}</p>

          <div className="flex items-center justify-between">
            <span className="text-xs px-2 py-1 bg-gray-100 text-gray-700 rounded">
              {look.category}
            </span>
            <div className="flex items-center gap-1 text-xs text-gray-600">
              <Users size={12} />
              <span>{look.recordCount} records</span>
            </div>
          </div>
        </button>
      );
    }

    // Conditions Builder Component
    function ConditionsBuilder({ data, onChange }) {
      return (
        <div className="space-y-6">
          <div>
            <h2 className="text-2xl font-bold text-gray-900 mb-2">Add conditions (optional)</h2>
            <p className="text-gray-600">Further filter which records should trigger actions</p>
          </div>

          <div className="space-y-3">
            {data.conditions.map((condition, idx) => (
              <div key={idx} className="flex items-center gap-3 p-4 bg-gray-50 rounded-lg">
                <span className="text-sm font-medium text-gray-600">AND</span>
                <select className="flex-1 px-3 py-2 border border-gray-300 rounded-lg bg-white">
                  <option value="premium">Premium</option>
                  <option value="renewalActivity">Renewal Activity</option>
                  <option value="lastContact">Last Contact</option>
                  <option value="claimCount">Claim Count</option>
                </select>
                <select className="px-3 py-2 border border-gray-300 rounded-lg bg-white">
                  <option value="greaterThan">greater than</option>
                  <option value="equals">equals</option>
                  <option value="lessThan">less than</option>
                  <option value="contains">contains</option>
                </select>
                <input
                  type="text"
                  value={condition.value}
                  className="w-32 px-3 py-2 border border-gray-300 rounded-lg"
                  placeholder="Value"
                />
                <button className="text-red-600 hover:text-red-700 p-2">
                  <X size={20} />
                </button>
              </div>
            ))}
            <button className="text-blue-600 hover:text-blue-700 font-medium flex items-center gap-2">
              <Plus size={20} />
              Add condition
            </button>
          </div>

          <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
            <div className="flex items-start gap-3">
              <Users className="text-blue-600 mt-0.5" size={20} />
              <div>
                <p className="font-medium text-blue-900">This will filter to ~156 policies</p>
                <p className="text-sm text-blue-700 mt-1">91 fewer than without conditions</p>
              </div>
            </div>
          </div>
        </div>
      );
    }

    // Actions Builder Component
    function ActionsBuilder({ data, onChange }) {
      const [showActionMenu, setShowActionMenu] = useState(false);
      const [viewMode, setViewMode] = useState('list'); // 'list' or 'flow'

      const actions = data.actions || [];

      const actionTypes = [
        { id: 'campaign', name: 'Send Campaign', icon: 'üìß', color: 'blue', category: 'Communication' },
        { id: 'activity', name: 'Create Activity', icon: 'üìã', color: 'purple', category: 'Task Management' },
        { id: 'submission', name: 'Create Submission', icon: 'üìÑ', color: 'indigo', category: 'Sales Process' },
        { id: 'quote', name: 'Generate Quote', icon: 'üí∞', color: 'green', category: 'Sales Process' },
        { id: 'proposal', name: 'Build Proposal', icon: 'üìä', color: 'orange', category: 'Sales Process' },
        { id: 'notification', name: 'Send Notification', icon: 'üîî', color: 'yellow', category: 'Communication' },
        { id: 'webhook', name: 'Call Webhook', icon: 'üîó', color: 'gray', category: 'Integration' },
        { id: 'update_data', name: 'Update Data', icon: '‚úèÔ∏è', color: 'teal', category: 'Data Management' },
        { id: 'wait', name: 'Wait/Delay', icon: '‚è±Ô∏è', color: 'slate', category: 'Flow Control' },
        { id: 'condition', name: 'Conditional Branch', icon: 'üîÄ', color: 'pink', category: 'Flow Control' }
      ];

      const addAction = (actionType) => {
        const newActions = [...actions, {
          id: Date.now(),
          type: actionType,
          expanded: true
        }];
        onChange({ ...data, actions: newActions });
        setShowActionMenu(false);
      };

      const removeAction = (actionId) => {
        const newActions = actions.filter(a => a.id !== actionId);
        onChange({ ...data, actions: newActions });
      };

      const toggleExpand = (actionId) => {
        const newActions = actions.map(a =>
          a.id === actionId ? { ...a, expanded: !a.expanded } : a
        );
        onChange({ ...data, actions: newActions });
      };

      const moveAction = (actionId, direction) => {
        const index = actions.findIndex(a => a.id === actionId);
        if (direction === 'up' && index > 0) {
          const newActions = [...actions];
          [newActions[index - 1], newActions[index]] = [newActions[index], newActions[index - 1]];
          onChange({ ...data, actions: newActions });
        } else if (direction === 'down' && index < actions.length - 1) {
          const newActions = [...actions];
          [newActions[index], newActions[index + 1]] = [newActions[index + 1], newActions[index]];
          onChange({ ...data, actions: newActions });
        }
      };

      return (
        <div className="space-y-6">
          <div className="flex items-start justify-between">
            <div>
              <h2 className="text-2xl font-bold text-gray-900 mb-2">What should happen?</h2>
              <p className="text-gray-600">Configure actions and build complex workflows</p>
            </div>
            <div className="flex gap-2">
              <button
                onClick={() => setViewMode('list')}
                className={`px-4 py-2 rounded-lg font-medium transition-colors ${viewMode === 'list'
                  ? 'bg-blue-600 text-white'
                  : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'
                  }`}
              >
                List View
              </button>
              <button
                onClick={() => setViewMode('flow')}
                className={`px-4 py-2 rounded-lg font-medium transition-colors ${viewMode === 'flow'
                  ? 'bg-blue-600 text-white'
                  : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'
                  }`}
              >
                Flow View
              </button>
            </div>
          </div>

          {viewMode === 'list' ? (
            <div className="space-y-4">
              {actions.map((action, index) => (
                <ActionCard
                  key={action.id}
                  action={action}
                  index={index}
                  totalActions={actions.length}
                  onRemove={() => removeAction(action.id)}
                  onToggleExpand={() => toggleExpand(action.id)}
                  onMove={(direction) => moveAction(action.id, direction)}
                />
              ))}

              {/* Add Action Button/Menu */}
              <div className="relative">
                {!showActionMenu ? (
                  <button
                    onClick={() => setShowActionMenu(true)}
                    className="w-full border-2 border-dashed border-gray-300 rounded-lg p-6 text-blue-600 hover:text-blue-700 hover:border-blue-400 hover:bg-blue-50 font-medium flex items-center justify-center gap-2 transition-colors"
                  >
                    <Plus size={20} />
                    Add Action
                  </button>
                ) : (
                  <div className="border-2 border-blue-400 rounded-lg p-6 bg-blue-50">
                    <div className="flex items-center justify-between mb-4">
                      <h3 className="font-bold text-gray-900">Choose Action Type</h3>
                      <button
                        onClick={() => setShowActionMenu(false)}
                        className="text-gray-400 hover:text-gray-600"
                      >
                        <X size={20} />
                      </button>
                    </div>

                    {['Communication', 'Sales Process', 'Task Management', 'Data Management', 'Flow Control', 'Integration'].map(category => (
                      <div key={category} className="mb-4">
                        <h4 className="text-xs font-semibold text-gray-500 uppercase mb-2">{category}</h4>
                        <div className="grid grid-cols-2 gap-2">
                          {actionTypes.filter(at => at.category === category).map(actionType => (
                            <button
                              key={actionType.id}
                              onClick={() => addAction(actionType.id)}
                              className="flex items-center gap-3 p-3 bg-white border border-gray-200 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-colors text-left"
                            >
                              <span className="text-2xl">{actionType.icon}</span>
                              <span className="font-medium text-gray-900 text-sm">{actionType.name}</span>
                            </button>
                          ))}
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            </div>
          ) : (
            <FlowView actions={actions} />
          )}
        </div>
      );
    }

    // Action Card Component
    function ActionCard({ action, index, totalActions, onRemove, onToggleExpand, onMove }) {
      const actionConfig = {
        campaign: { icon: 'üìß', color: 'blue', title: 'Send Campaign' },
        activity: { icon: 'üìã', color: 'purple', title: 'Create Activity' },
        submission: { icon: 'üìÑ', color: 'indigo', title: 'Create Submission' },
        quote: { icon: 'üí∞', color: 'green', title: 'Generate Quote' },
        proposal: { icon: 'üìä', color: 'orange', title: 'Build Proposal' },
        notification: { icon: 'üîî', color: 'yellow', title: 'Send Notification' },
        webhook: { icon: 'üîó', color: 'gray', title: 'Call Webhook' },
        update_data: { icon: '‚úèÔ∏è', color: 'teal', title: 'Update Data' },
        wait: { icon: '‚è±Ô∏è', color: 'slate', title: 'Wait/Delay' },
        condition: { icon: 'üîÄ', color: 'pink', title: 'Conditional Branch' }
      };

      const config = actionConfig[action.type];

      return (
        <div className="border border-gray-200 rounded-lg overflow-hidden">
          {/* Action Header */}
          <div className={`bg-${config.color}-50 border-b border-${config.color}-100 p-4`}>
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-3 flex-1">
                <span className="text-2xl">{config.icon}</span>
                <div className="flex-1">
                  <h3 className="font-bold text-gray-900">
                    Action {index + 1}: {config.title}
                  </h3>
                  {!action.expanded && (
                    <p className="text-xs text-gray-600 mt-1">Click to configure</p>
                  )}
                </div>
              </div>
              <div className="flex items-center gap-2">
                {index > 0 && (
                  <button
                    onClick={() => onMove('up')}
                    className="p-1 text-gray-400 hover:text-gray-600"
                    title="Move up"
                  >
                    ‚Üë
                  </button>
                )}
                {index < totalActions - 1 && (
                  <button
                    onClick={() => onMove('down')}
                    className="p-1 text-gray-400 hover:text-gray-600"
                    title="Move down"
                  >
                    ‚Üì
                  </button>
                )}
                <button
                  onClick={onToggleExpand}
                  className="p-1 text-gray-400 hover:text-gray-600"
                >
                  {action.expanded ? '‚àí' : '+'}
                </button>
                <button
                  onClick={onRemove}
                  className="p-1 text-red-600 hover:text-red-700"
                >
                  <X size={20} />
                </button>
              </div>
            </div>
          </div>

          {/* Action Configuration */}
          {action.expanded && (
            <div className="p-6">
              {action.type === 'campaign' && <CampaignActionConfig />}
              {action.type === 'activity' && <ActivityActionConfig />}
              {action.type === 'submission' && <SubmissionActionConfig />}
              {action.type === 'quote' && <QuoteActionConfig />}
              {action.type === 'proposal' && <ProposalActionConfig />}
              {action.type === 'notification' && <NotificationActionConfig />}
              {action.type === 'webhook' && <WebhookActionConfig />}
              {action.type === 'update_data' && <UpdateDataActionConfig />}
              {action.type === 'wait' && <WaitActionConfig />}
              {action.type === 'condition' && <ConditionActionConfig />}
            </div>
          )}
        </div>
      );
    }

    // Flow View Component
    function FlowView({ actions }) {
      const [data] = useState({}); // This would come from parent in real implementation

      return (
        <div className="bg-white border border-gray-200 rounded-lg p-8">
          <div className="flex items-center justify-center">
            <div className="space-y-4">
              {/* Trigger */}
              <div className="flex items-center justify-center">
                <div className="bg-green-100 border-2 border-green-500 rounded-lg p-4 text-center min-w-[280px]">
                  <div className="text-2xl mb-2">üéØ</div>
                  <div className="font-bold text-gray-900">Trigger</div>
                  <div className="text-xs text-gray-600 mt-1">Query matches records</div>
                  {data.querySource === 'looker' && (
                    <div className="mt-2 px-2 py-1 bg-purple-100 text-purple-800 text-xs font-bold rounded inline-block">
                      üìä Looker Look
                    </div>
                  )}
                </div>
              </div>

              {/* Arrow */}
              <div className="flex justify-center">
                <div className="w-1 h-8 bg-gray-300"></div>
              </div>

              {/* Actions */}
              {actions.map((action, index) => {
                const actionConfig = {
                  campaign: { icon: 'üìß', color: 'blue', title: 'Send Campaign' },
                  activity: { icon: 'üìã', color: 'purple', title: 'Create Activity' },
                  submission: { icon: 'üìÑ', color: 'indigo', title: 'Create Submission' },
                  quote: { icon: 'üí∞', color: 'green', title: 'Generate Quote' },
                  proposal: { icon: 'üìä', color: 'orange', title: 'Build Proposal' },
                  notification: { icon: 'üîî', color: 'yellow', title: 'Send Notification' },
                  webhook: { icon: 'üîó', color: 'gray', title: 'Call Webhook' },
                  update_data: { icon: '‚úèÔ∏è', color: 'teal', title: 'Update Data' },
                  wait: { icon: '‚è±Ô∏è', color: 'slate', title: 'Wait/Delay' },
                  condition: { icon: 'üîÄ', color: 'pink', title: 'Conditional Branch' }
                };
                const config = actionConfig[action.type];

                return (
                  <React.Fragment key={action.id}>
                    <div className="flex items-center justify-center">
                      <div className={`bg-${config.color}-100 border-2 border-${config.color}-500 rounded-lg p-4 text-center min-w-[280px]`}>
                        <div className="text-2xl mb-2">{config.icon}</div>
                        <div className="font-bold text-gray-900 text-sm">{config.title}</div>
                        <div className="text-xs text-gray-600 mt-1">Action {index + 1}</div>
                      </div>
                    </div>
                    {index < actions.length - 1 && (
                      <div className="flex justify-center">
                        <div className="w-1 h-8 bg-gray-300"></div>
                      </div>
                    )}
                  </React.Fragment>
                );
              })}

              {/* End */}
              <div className="flex justify-center">
                <div className="w-1 h-8 bg-gray-300"></div>
              </div>
              <div className="flex items-center justify-center">
                <div className="bg-gray-100 border-2 border-gray-400 rounded-lg p-4 text-center">
                  <div className="text-2xl mb-2">‚úì</div>
                  <div className="font-bold text-gray-900">Complete</div>
                </div>
              </div>
            </div>
          </div>

          <div className="mt-8 p-4 bg-blue-50 border border-blue-200 rounded-lg">
            <p className="text-sm text-blue-900">
              <strong>Flow Execution:</strong> Actions execute sequentially from top to bottom.
              Each action completes before the next begins. Use Wait actions to add delays between steps.
            </p>
          </div>
        </div>
      );
    }

    // Action Configuration Components
    function CampaignActionConfig() {
      return (
        <div className="space-y-4">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Campaign Template</label>
            <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
              <option>Renewal Reminder</option>
              <option>Policy Review</option>
              <option>Cross-Sell Opportunity</option>
              <option>Welcome Series</option>
            </select>
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Send to</label>
            <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
              <option>Insured Email</option>
              <option>Account Manager</option>
              <option>Additional Insured</option>
            </select>
          </div>
        </div>
      );
    }

    function ActivityActionConfig() {
      return (
        <div className="space-y-4">
          <div className="grid grid-cols-2 gap-4">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">Activity Type</label>
              <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
                <option>Follow-up Call</option>
                <option>Email Follow-up</option>
                <option>Schedule Meeting</option>
                <option>Review Policy</option>
              </select>
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">Assign to</label>
              <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
                <option>Policy CSR</option>
                <option>Account Manager</option>
                <option>Producer</option>
              </select>
            </div>
          </div>
        </div>
      );
    }

    function SubmissionActionConfig() {
      return (
        <div className="space-y-4">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Submission Type</label>
            <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
              <option>New Business</option>
              <option>Renewal</option>
              <option>Policy Change</option>
            </select>
          </div>
          <div className="grid grid-cols-2 gap-4">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">Line of Business</label>
              <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
                <option>Commercial Auto</option>
                <option>General Liability</option>
                <option>Workers Comp</option>
                <option>Property</option>
              </select>
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">Assign to Producer</label>
              <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
                <option>Primary Producer</option>
                <option>Round Robin</option>
                <option>Specific User</option>
              </select>
            </div>
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Pre-fill from</label>
            <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
              <option>Current Policy Data</option>
              <option>Client Profile</option>
              <option>Previous Submission</option>
            </select>
          </div>
        </div>
      );
    }

    function QuoteActionConfig() {
      return (
        <div className="space-y-4">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Quote Type</label>
            <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
              <option>Standard Quote</option>
              <option>Quick Quote</option>
              <option>Comparative Quotes</option>
            </select>
          </div>
          <div className="grid grid-cols-2 gap-4">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">Number of Carriers</label>
              <input type="number" defaultValue="3" className="w-full px-4 py-2 border border-gray-300 rounded-lg" />
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">Valid for (days)</label>
              <input type="number" defaultValue="30" className="w-full px-4 py-2 border border-gray-300 rounded-lg" />
            </div>
          </div>
          <div>
            <label className="flex items-center gap-2">
              <input type="checkbox" className="rounded" />
              <span className="text-sm text-gray-700">Auto-send quote to client</span>
            </label>
          </div>
        </div>
      );
    }

    function ProposalActionConfig() {
      return (
        <div className="space-y-4">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Proposal Template</label>
            <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
              <option>Standard Commercial Package</option>
              <option>Professional Liability</option>
              <option>Personal Lines Bundle</option>
              <option>Custom Template</option>
            </select>
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Include Sections</label>
            <div className="space-y-2">
              <label className="flex items-center gap-2">
                <input type="checkbox" defaultChecked className="rounded" />
                <span className="text-sm text-gray-700">Coverage Summary</span>
              </label>
              <label className="flex items-center gap-2">
                <input type="checkbox" defaultChecked className="rounded" />
                <span className="text-sm text-gray-700">Premium Breakdown</span>
              </label>
              <label className="flex items-center gap-2">
                <input type="checkbox" className="rounded" />
                <span className="text-sm text-gray-700">Carrier Comparisons</span>
              </label>
              <label className="flex items-center gap-2">
                <input type="checkbox" defaultChecked className="rounded" />
                <span className="text-sm text-gray-700">Terms & Conditions</span>
              </label>
            </div>
          </div>
          <div>
            <label className="flex items-center gap-2">
              <input type="checkbox" defaultChecked className="rounded" />
              <span className="text-sm text-gray-700">Generate PDF and attach to client record</span>
            </label>
          </div>
        </div>
      );
    }

    function NotificationActionConfig() {
      return (
        <div className="space-y-4">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Notification Type</label>
            <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
              <option>Email</option>
              <option>SMS</option>
              <option>In-App</option>
              <option>Push Notification</option>
            </select>
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Recipients</label>
            <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
              <option>Assigned CSR</option>
              <option>Account Manager</option>
              <option>Producer</option>
              <option>Agency Owner</option>
            </select>
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Message</label>
            <textarea
              rows={3}
              placeholder="New submission created for {{client}}"
              className="w-full px-4 py-2 border border-gray-300 rounded-lg"
            />
          </div>
        </div>
      );
    }

    function WebhookActionConfig() {
      return (
        <div className="space-y-4">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Webhook URL</label>
            <input
              type="text"
              placeholder="https://api.example.com/webhook"
              className="w-full px-4 py-2 border border-gray-300 rounded-lg font-mono text-sm"
            />
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Method</label>
            <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
              <option>POST</option>
              <option>PUT</option>
              <option>PATCH</option>
            </select>
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Authentication</label>
            <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
              <option>None</option>
              <option>API Key</option>
              <option>Bearer Token</option>
              <option>OAuth 2.0</option>
            </select>
          </div>
        </div>
      );
    }

    function UpdateDataActionConfig() {
      return (
        <div className="space-y-4">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Update Field</label>
            <select className="w-full px-4 py-2 border border-gray-300 rounded-lg">
              <option>Policy Status</option>
              <option>Client Tag</option>
              <option>Next Review Date</option>
              <option>Custom Field</option>
            </select>
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Set Value To</label>
            <input
              type="text"
              placeholder="New value or {{variable}}"
              className="w-full px-4 py-2 border border-gray-300 rounded-lg"
            />
          </div>
        </div>
      );
    }

    function WaitActionConfig() {
      return (
        <div className="space-y-4">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Wait Duration</label>
            <div className="flex gap-2">
              <input type="number" defaultValue="1" className="w-24 px-4 py-2 border border-gray-300 rounded-lg" />
              <select className="flex-1 px-4 py-2 border border-gray-300 rounded-lg">
                <option>hours</option>
                <option>days</option>
                <option>weeks</option>
              </select>
            </div>
          </div>
          <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
            <p className="text-sm text-yellow-800">
              ‚è±Ô∏è The workflow will pause here before continuing to the next action
            </p>
          </div>
        </div>
      );
    }

    function ConditionActionConfig() {
      return (
        <div className="space-y-4">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">Condition</label>
            <div className="flex gap-2">
              <select className="flex-1 px-4 py-2 border border-gray-300 rounded-lg">
                <option>Quote Status</option>
                <option>Premium Amount</option>
                <option>Client Response</option>
                <option>Days Since Created</option>
              </select>
              <select className="px-4 py-2 border border-gray-300 rounded-lg">
                <option>equals</option>
                <option>greater than</option>
                <option>less than</option>
              </select>
              <input type="text" className="w-32 px-4 py-2 border border-gray-300 rounded-lg" />
            </div>
          </div>
          <div className="bg-pink-50 border border-pink-200 rounded-lg p-3">
            <p className="text-sm text-pink-800">
              üîÄ Actions below will only execute if this condition is met
            </p>
          </div>
        </div>
      );
    }

    // Schedule Builder Component
    function ScheduleBuilder({ data, onChange }) {
      return (
        <div className="space-y-6">
          <div>
            <h2 className="text-2xl font-bold text-gray-900 mb-2">When should this run?</h2>
            <p className="text-gray-600">Set up the automation schedule</p>
          </div>

          <div className="space-y-4">
            <label className="flex items-start gap-3 p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-300 hover:bg-blue-50 transition-colors">
              <input type="radio" name="schedule" className="mt-1" />
              <div>
                <div className="font-medium text-gray-900">Once (run now and stop)</div>
                <div className="text-sm text-gray-600">Execute immediately for current matching records</div>
              </div>
            </label>

            <label className="flex items-start gap-3 p-4 border-2 border-blue-300 bg-blue-50 rounded-lg cursor-pointer">
              <input type="radio" name="schedule" defaultChecked className="mt-1" />
              <div className="flex-1">
                <div className="font-medium text-gray-900 mb-3">Daily</div>
                <div className="flex gap-3 items-center">
                  <span className="text-sm text-gray-600">at</span>
                  <input type="time" defaultValue="09:00" className="px-3 py-2 border border-gray-300 rounded-lg" />
                  <select className="px-3 py-2 border border-gray-300 rounded-lg">
                    <option>America/New_York</option>
                    <option>America/Chicago</option>
                    <option>America/Los_Angeles</option>
                  </select>
                </div>
              </div>
            </label>

            <label className="flex items-start gap-3 p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-300 hover:bg-blue-50 transition-colors">
              <input type="radio" name="schedule" className="mt-1" />
              <div className="flex-1">
                <div className="font-medium text-gray-900 mb-3">Weekly</div>
                <div className="flex gap-3 items-center">
                  <span className="text-sm text-gray-600">on</span>
                  <select className="px-3 py-2 border border-gray-300 rounded-lg">
                    <option>Monday</option>
                    <option>Tuesday</option>
                    <option>Wednesday</option>
                    <option>Thursday</option>
                    <option>Friday</option>
                  </select>
                  <span className="text-sm text-gray-600">at</span>
                  <input type="time" defaultValue="09:00" className="px-3 py-2 border border-gray-300 rounded-lg" />
                </div>
              </div>
            </label>

            <label className="flex items-start gap-3 p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-300 hover:bg-blue-50 transition-colors">
              <input type="radio" name="schedule" className="mt-1" />
              <div className="flex-1">
                <div className="font-medium text-gray-900 mb-3">Monthly</div>
                <div className="flex gap-3 items-center">
                  <span className="text-sm text-gray-600">on the</span>
                  <select className="px-3 py-2 border border-gray-300 rounded-lg">
                    <option>1st</option>
                    <option>15th</option>
                    <option>Last day</option>
                  </select>
                  <span className="text-sm text-gray-600">at</span>
                  <input type="time" defaultValue="09:00" className="px-3 py-2 border border-gray-300 rounded-lg" />
                </div>
              </div>
            </label>
          </div>

          <div className="flex gap-3 pt-4">
            <button className="flex-1 px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 flex items-center justify-center gap-2">
              <Play size={20} />
              Test with sample data
            </button>
          </div>

          <div className="bg-green-50 border border-green-200 rounded-lg p-4">
            <div className="flex items-start gap-3">
              <Check className="text-green-600 mt-0.5" size={20} />
              <div>
                <p className="font-medium text-green-900">Ready to activate</p>
                <p className="text-sm text-green-700 mt-1">This automation will run daily at 9:00 AM EST, processing ~156 policies and executing 312 actions</p>
              </div>
            </div>
          </div>
        </div>
      );
    }

    // Supporting Components
    function MetricCard({ title, value, subtitle, icon, trend, trendLabel }) {
      const isPositive = trend && trend.startsWith('+');

      return (
        <div className="bg-white rounded-lg border border-gray-200 p-4">
          <div className="flex items-start justify-between mb-3">
            <div className="p-2 bg-gray-50 rounded-lg">
              {icon}
            </div>
            {trend && (
              <div className={`text-right ${isPositive ? 'text-green-600' : 'text-red-600'}`}>
                <div className="text-sm font-bold">{trend}</div>
                {trendLabel && (
                  <div className="text-xs text-gray-600">{trendLabel}</div>
                )}
              </div>
            )}
          </div>
          <div className="text-2xl font-bold text-gray-900 mb-1">{value}</div>
          <div className="text-xs text-gray-600">{title}</div>
          {subtitle && <div className="text-xs text-gray-500 mt-0.5">{subtitle}</div>}
        </div>
      );
    }

    function AutomationCard({ automation, onView }) {
      const statusColors = {
        active: 'bg-green-100 text-green-800',
        paused: 'bg-yellow-100 text-yellow-800',
        draft: 'bg-gray-100 text-gray-800'
      };

      const isInsights = automation.type === 'insights';

      return (
        <div className={`bg-white rounded-lg border-2 p-6 hover:shadow-lg transition-all ${isInsights ? 'border-purple-200' : 'border-gray-200'
          }`}>
          <div className="flex items-start justify-between mb-4">
            <div className="flex-1">
              <div className="flex items-center gap-3 mb-2">
                <h3 className="text-lg font-bold text-gray-900">{automation.name}</h3>
                {isInsights && (
                  <span className="bg-purple-100 text-purple-800 text-xs font-bold px-2 py-1 rounded flex items-center gap-1">
                    <Brain size={12} />
                    INSIGHTS
                  </span>
                )}
                <span className={`px-2 py-1 rounded-full text-xs font-medium ${statusColors[automation.status]}`}>
                  {automation.status === 'active' ? 'üü¢' : automation.status === 'paused' ? '‚è∏Ô∏è' : 'üìù'} {automation.status}
                </span>
                {isInsights && automation.lastRun?.triggered && (
                  <span className="bg-orange-100 text-orange-800 text-xs font-bold px-2 py-1 rounded flex items-center gap-1">
                    <Zap size={12} />
                    TRIGGERED
                  </span>
                )}
              </div>
              <p className="text-sm text-gray-600">{automation.description}</p>
            </div>
            <button className="text-gray-400 hover:text-gray-600 p-2">
              <MoreVertical size={20} />
            </button>
          </div>

          {/* Insights-specific trigger display */}
          {isInsights && automation.trigger ? (
            <div className="mb-4 space-y-3">
              {/*<div className="bg-gray-50 rounded-lg p-4 space-y-2">
                <div>
                  <div className="text-xs font-medium text-gray-500 mb-1">Trigger Type</div>
                  <div className="flex items-center gap-2">
                    <span className="text-2xl">{automation.trigger.icon}</span>
                    <span className="font-medium text-gray-900">{automation.trigger.type}</span>
                  </div>
                </div>
                <div>
                  <div className="text-xs font-medium text-gray-500 mb-1">Entity</div>
                  <div className="text-sm text-gray-900">{automation.trigger.entity}</div>
                </div>
                <div>
                  <div className="text-xs font-medium text-gray-500 mb-1">Condition / Schedule</div>
                  <div className="text-sm text-gray-900 font-mono">{automation.trigger.condition}</div>
                </div>
                <div>
                  <div className="text-xs font-medium text-gray-500 mb-1">Check Frequency</div>
                  <div className="text-sm text-gray-900">{automation.trigger.checkFrequency}</div>
                </div>
              </div>*/}

              {automation.lastRun?.insight && (
                <div className="bg-orange-50 border border-orange-200 rounded-lg p-3">
                  <div className="flex items-center gap-2">
                    <AlertTriangle size={16} className="text-orange-600" />
                    <span className="text-sm font-medium text-orange-900">{automation.lastRun.insight}</span>
                  </div>
                </div>
              )}
            </div>
          ) : (
            <div className="flex items-center gap-6 text-sm text-gray-600 mb-4">
              <div className="flex items-center gap-2">
                <Clock size={16} />
                <span>{automation.trigger.schedule}</span>
              </div>
              <div className="flex items-center gap-2">
                <span>‚Ä¢</span>
                <span>{automation.trigger.entity}</span>
              </div>
            </div>
          )}

          {automation.lastRun && (
            <>
              <div className="border-t border-gray-200 pt-4 mb-4">
                <div className="flex items-center justify-between text-sm mb-3">
                  <span className="text-gray-600">Last run: {automation.lastRun.date}</span>
                  {!isInsights && automation.lastRun.successRate && (
                    <span className="font-medium text-gray-900">Success rate: {automation.lastRun.successRate}%</span>
                  )}
                </div>
                <div className="grid grid-cols-3 gap-4">
                  <div>
                    <div className="text-2xl font-bold text-gray-900">{automation.lastRun.recordsProcessed}</div>
                    <div className="text-xs text-gray-600">Records processed</div>
                  </div>
                  <div>
                    <div className="text-2xl font-bold text-gray-900">{automation.lastRun.actionsExecuted}</div>
                    <div className="text-xs text-gray-600">Actions executed</div>
                  </div>
                  {isInsights && automation.metrics ? (
                    <div>
                      <div className="text-2xl font-bold text-purple-600">{automation.metrics.accuracy}</div>
                      <div className="text-xs text-gray-600">Accuracy</div>
                    </div>
                  ) : (
                    <div>
                      <div className="text-2xl font-bold text-blue-600">{automation.actions.length}</div>
                      <div className="text-xs text-gray-600">Action types</div>
                    </div>
                  )}
                </div>
              </div>

              <div className="flex items-center justify-between">
                <div className="flex gap-2 flex-wrap">
                  {automation.actions.slice(0, 3).map((action, idx) => (
                    <span key={idx} className="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-medium">
                      {action}
                    </span>
                  ))}
                  {automation.actions.length > 3 && (
                    <span className="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-medium">
                      +{automation.actions.length - 3} more
                    </span>
                  )}
                </div>

                {onView && (
                  <button
                    onClick={() => onView(automation)}
                    className="ml-4 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 flex items-center gap-2"
                  >
                    View Details
                    <ChevronRight size={16} />
                  </button>
                )}
              </div>
            </>
          )}
        </div>
      );
    }

    // Automation View Page
    function AutomationViewPage({ automation, onBack, onEdit }) {
      const [viewTab, setViewTab] = useState('overview'); // 'overview', 'configuration', 'history', 'performance'

      // Generate mock execution history
      const executionHistory = [
        { date: '2024-12-18 09:00', records: 247, success: 242, failed: 5, duration: '4.2s', status: 'completed' },
        { date: '2024-12-17 09:00', records: 243, success: 241, failed: 2, duration: '3.8s', status: 'completed' },
        { date: '2024-12-16 09:00', records: 251, success: 248, failed: 3, duration: '4.5s', status: 'completed' },
        { date: '2024-12-15 09:00', records: 239, success: 239, failed: 0, duration: '3.9s', status: 'completed' },
        { date: '2024-12-14 09:00', records: 245, success: 242, failed: 3, duration: '4.1s', status: 'completed' },
      ];

      return (
        <div className="max-w-6xl mx-auto space-y-6">
          {/* Header */}
          <div>
            <button onClick={onBack} className="text-blue-600 hover:text-blue-700 mb-4 flex items-center gap-2">
              ‚Üê Back to Dashboard
            </button>

            <div className="bg-white rounded-lg border border-gray-200 p-6">
              <div className="flex items-start justify-between">
                <div className="flex-1">
                  <div className="flex items-center gap-3 mb-2">
                    <h1 className="text-3xl font-bold text-gray-900">{automation.name}</h1>
                    <span className={`px-3 py-1 rounded-full text-sm font-medium ${automation.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'
                      }`}>
                      {automation.status === 'active' ? 'üü¢ Active' : '‚è∏Ô∏è Paused'}
                    </span>
                  </div>
                  <p className="text-gray-600">{automation.description}</p>
                </div>
                <div className="flex gap-3">
                  <button
                    onClick={onEdit}
                    className="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 flex items-center gap-2"
                  >
                    Edit
                  </button>
                  <button className="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50">
                    {automation.status === 'active' ? 'Pause' : 'Activate'}
                  </button>
                  <button className="p-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                    <MoreVertical size={20} />
                  </button>
                </div>
              </div>
            </div>
          </div>

          {/* Quick Stats */}
          <div className="grid grid-cols-4 gap-4">
            <div className="bg-white rounded-lg border border-gray-200 p-4">
              <div className="text-2xl font-bold text-gray-900">98%</div>
              <div className="text-sm text-gray-600">Success Rate</div>
              <div className="text-xs text-green-600 mt-1">+2% this week</div>
            </div>
            <div className="bg-white rounded-lg border border-gray-200 p-4">
              <div className="text-2xl font-bold text-gray-900">1,225</div>
              <div className="text-sm text-gray-600">Total Executions</div>
              <div className="text-xs text-gray-600 mt-1">Last 30 days</div>
            </div>
            <div className="bg-white rounded-lg border border-gray-200 p-4">
              <div className="text-2xl font-bold text-gray-900">247</div>
              <div className="text-sm text-gray-600">Avg Records/Run</div>
              <div className="text-xs text-blue-600 mt-1">+12 vs last month</div>
            </div>
            <div className="bg-white rounded-lg border border-gray-200 p-4">
              <div className="text-2xl font-bold text-gray-900">4.1s</div>
              <div className="text-sm text-gray-600">Avg Duration</div>
              <div className="text-xs text-gray-600 mt-1">Per execution</div>
            </div>
          </div>

          {/* Tabs */}
          <div className="bg-white rounded-lg border border-gray-200">
            <div className="border-b border-gray-200">
              <nav className="flex px-6">
                <button
                  onClick={() => setViewTab('overview')}
                  className={`py-4 px-4 border-b-2 font-medium transition-colors ${viewTab === 'overview'
                    ? 'border-blue-600 text-blue-600'
                    : 'border-transparent text-gray-600 hover:text-gray-900'
                    }`}
                >
                  Overview
                </button>
                <button
                  onClick={() => setViewTab('configuration')}
                  className={`py-4 px-4 border-b-2 font-medium transition-colors ${viewTab === 'configuration'
                    ? 'border-blue-600 text-blue-600'
                    : 'border-transparent text-gray-600 hover:text-gray-900'
                    }`}
                >
                  Configuration
                </button>
                <button
                  onClick={() => setViewTab('history')}
                  className={`py-4 px-4 border-b-2 font-medium transition-colors ${viewTab === 'history'
                    ? 'border-blue-600 text-blue-600'
                    : 'border-transparent text-gray-600 hover:text-gray-900'
                    }`}
                >
                  Execution History
                </button>
                <button
                  onClick={() => setViewTab('performance')}
                  className={`py-4 px-4 border-b-2 font-medium transition-colors ${viewTab === 'performance'
                    ? 'border-blue-600 text-blue-600'
                    : 'border-transparent text-gray-600 hover:text-gray-900'
                    }`}
                >
                  Performance
                </button>
              </nav>
            </div>

            <div className="p-6">
              {viewTab === 'overview' && <AutomationOverviewTab automation={automation} />}
              {viewTab === 'configuration' && <AutomationConfigurationTab automation={automation} />}
              {viewTab === 'history' && <AutomationHistoryTab history={executionHistory} />}
              {viewTab === 'performance' && <AutomationPerformanceTab automation={automation} />}
            </div>
          </div>
        </div>
      );
    }

    // Overview Tab
    function AutomationOverviewTab({ automation }) {
      return (
        <div className="space-y-6">
          {/* Schedule Information */}
          <div>
            <h3 className="text-lg font-bold text-gray-900 mb-4">Schedule</h3>
            <div className="bg-gray-50 rounded-lg p-4 border border-gray-200">
              <div className="flex items-center gap-3">
                <Clock className="text-blue-600" size={24} />
                <div>
                  <div className="font-medium text-gray-900">{automation.trigger.schedule}</div>
                  <div className="text-sm text-gray-600">Next run: Today at 9:00 AM</div>
                </div>
              </div>
            </div>
          </div>

          {/* Data Source */}
          <div>
            <h3 className="text-lg font-bold text-gray-900 mb-4">Data Source</h3>
            <div className="bg-gray-50 rounded-lg p-4 border border-gray-200">
              <div className="flex items-center gap-3">
                <Users className="text-purple-600" size={24} />
                <div>
                  <div className="font-medium text-gray-900">{automation.trigger.entity}</div>
                  <div className="text-sm text-gray-600">Expiring in next 60 days</div>
                </div>
              </div>
            </div>
          </div>

          {/* Actions */}
          <div>
            <h3 className="text-lg font-bold text-gray-900 mb-4">Actions ({automation.actions.length})</h3>
            <div className="space-y-3">
              {automation.actions.map((action, idx) => (
                <div key={idx} className="bg-gray-50 rounded-lg p-4 border border-gray-200">
                  <div className="flex items-center gap-3">
                    <div className="bg-white rounded-lg p-2">
                      {action === 'Send Campaign' ? <Mail className="text-blue-600" size={20} /> : <ClipboardList className="text-purple-600" size={20} />}
                    </div>
                    <div>
                      <div className="font-medium text-gray-900">{action}</div>
                      <div className="text-sm text-gray-600">
                        {action === 'Send Campaign' ? 'Renewal Reminder template' : 'Assign to Policy CSR'}
                      </div>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </div>

          {/* Recent Activity */}
          <div>
            <h3 className="text-lg font-bold text-gray-900 mb-4">Recent Activity</h3>
            <div className="space-y-3">
              <div className="flex items-start gap-3 text-sm">
                <div className="w-2 h-2 bg-green-500 rounded-full mt-1.5"></div>
                <div className="flex-1">
                  <div className="text-gray-900">Execution completed successfully</div>
                  <div className="text-gray-600">247 records processed, 2 hours ago</div>
                </div>
              </div>
              <div className="flex items-start gap-3 text-sm">
                <div className="w-2 h-2 bg-green-500 rounded-full mt-1.5"></div>
                <div className="flex-1">
                  <div className="text-gray-900">Execution completed successfully</div>
                  <div className="text-gray-600">243 records processed, 1 day ago</div>
                </div>
              </div>
              <div className="flex items-start gap-3 text-sm">
                <div className="w-2 h-2 bg-green-500 rounded-full mt-1.5"></div>
                <div className="flex-1">
                  <div className="text-gray-900">Execution completed successfully</div>
                  <div className="text-gray-600">251 records processed, 2 days ago</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    }

    // Configuration Tab
    function AutomationConfigurationTab({ automation }) {
      return (
        <div className="space-y-6">
          <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
            <p className="text-sm text-blue-900">
              üí° This is a read-only view of the automation configuration. Click "Edit" above to make changes.
            </p>
          </div>

          {/* Query Configuration */}
          <div>
            <h3 className="text-lg font-bold text-gray-900 mb-4">Query Configuration</h3>
            <div className="bg-gray-50 rounded-lg p-4 border border-gray-200 space-y-3">
              <div>
                <div className="text-sm font-medium text-gray-600">Entity</div>
                <div className="text-gray-900">{automation.trigger.entity}</div>
              </div>
              <div>
                <div className="text-sm font-medium text-gray-600">Filters</div>
                <div className="text-gray-900">Expiration Date is in next 60 days</div>
              </div>
            </div>
          </div>

          {/* Conditions */}
          <div>
            <h3 className="text-lg font-bold text-gray-900 mb-4">Conditions</h3>
            <div className="bg-gray-50 rounded-lg p-4 border border-gray-200">
              <div className="text-gray-900">Premium greater than $5,000</div>
              <div className="text-gray-900 mt-2">No renewal activity in last 30 days</div>
            </div>
          </div>

          {/* Actions Configuration */}
          <div>
            <h3 className="text-lg font-bold text-gray-900 mb-4">Actions</h3>
            <div className="space-y-4">
              <div className="bg-gray-50 rounded-lg p-4 border border-gray-200">
                <div className="font-medium text-gray-900 mb-2">1. Send Campaign</div>
                <div className="space-y-1 text-sm">
                  <div><span className="text-gray-600">Template:</span> Renewal Reminder</div>
                  <div><span className="text-gray-600">Send to:</span> Insured Email</div>
                  <div><span className="text-gray-600">Personalization:</span> policy_number, exp_date, csr_name</div>
                </div>
              </div>
              <div className="bg-gray-50 rounded-lg p-4 border border-gray-200">
                <div className="font-medium text-gray-900 mb-2">2. Create Activity</div>
                <div className="space-y-1 text-sm">
                  <div><span className="text-gray-600">Type:</span> Follow-up Call</div>
                  <div><span className="text-gray-600">Assign to:</span> Policy CSR</div>
                  <div><span className="text-gray-600">Due in:</span> 7 days</div>
                  <div><span className="text-gray-600">Priority:</span> High</div>
                </div>
              </div>
            </div>
          </div>

          {/* Schedule */}
          <div>
            <h3 className="text-lg font-bold text-gray-900 mb-4">Schedule</h3>
            <div className="bg-gray-50 rounded-lg p-4 border border-gray-200">
              <div className="text-gray-900">{automation.trigger.schedule}</div>
              <div className="text-sm text-gray-600 mt-1">Timezone: America/New_York (EST)</div>
            </div>
          </div>
        </div>
      );
    }

    // History Tab
    function AutomationHistoryTab({ history }) {
      return (
        <div className="space-y-4">
          <div className="flex items-center justify-between">
            <h3 className="text-lg font-bold text-gray-900">Last 5 Executions</h3>
            <button className="text-sm text-blue-600 hover:text-blue-700 font-medium">
              View All History ‚Üí
            </button>
          </div>

          <div className="overflow-x-auto">
            <table className="w-full">
              <thead className="bg-gray-50 border-b border-gray-200">
                <tr>
                  <th className="text-left p-3 text-sm font-medium text-gray-600">Date & Time</th>
                  <th className="text-left p-3 text-sm font-medium text-gray-600">Records</th>
                  <th className="text-left p-3 text-sm font-medium text-gray-600">Success</th>
                  <th className="text-left p-3 text-sm font-medium text-gray-600">Failed</th>
                  <th className="text-left p-3 text-sm font-medium text-gray-600">Duration</th>
                  <th className="text-left p-3 text-sm font-medium text-gray-600">Status</th>
                  <th className="text-left p-3 text-sm font-medium text-gray-600"></th>
                </tr>
              </thead>
              <tbody className="divide-y divide-gray-200">
                {history.map((exec, idx) => (
                  <tr key={idx} className="hover:bg-gray-50">
                    <td className="p-3 text-sm text-gray-900">{exec.date}</td>
                    <td className="p-3 text-sm text-gray-900 font-medium">{exec.records}</td>
                    <td className="p-3 text-sm text-green-600 font-medium">{exec.success}</td>
                    <td className="p-3 text-sm text-red-600 font-medium">{exec.failed}</td>
                    <td className="p-3 text-sm text-gray-600">{exec.duration}</td>
                    <td className="p-3">
                      <span className="px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded">
                        {exec.status}
                      </span>
                    </td>
                    <td className="p-3">
                      <button className="text-blue-600 hover:text-blue-700 text-sm">
                        View Details
                      </button>
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        </div>
      );
    }

    // Performance Tab
    function AutomationPerformanceTab({ automation }) {
      return (
        <div className="space-y-6">
          {/* Performance Chart Placeholder */}
          <div>
            <h3 className="text-lg font-bold text-gray-900 mb-4">Execution Trend (Last 30 Days)</h3>
            <div className="bg-gray-50 rounded-lg p-8 border border-gray-200 text-center">
              <div className="text-4xl mb-2">üìä</div>
              <div className="text-gray-600">Chart showing execution volume and success rate over time</div>
            </div>
          </div>

          {/* Performance Metrics */}
          <div>
            <h3 className="text-lg font-bold text-gray-900 mb-4">Performance Metrics</h3>
            <div className="grid grid-cols-2 gap-4">
              <div className="bg-white rounded-lg p-4 border border-gray-200">
                <div className="text-sm text-gray-600 mb-1">Average Records Per Run</div>
                <div className="text-2xl font-bold text-gray-900">247</div>
                <div className="text-xs text-green-600 mt-1">+12 vs last month</div>
              </div>
              <div className="bg-white rounded-lg p-4 border border-gray-200">
                <div className="text-sm text-gray-600 mb-1">Average Execution Time</div>
                <div className="text-2xl font-bold text-gray-900">4.1s</div>
                <div className="text-xs text-gray-600 mt-1">-0.3s vs last month</div>
              </div>
              <div className="bg-white rounded-lg p-4 border border-gray-200">
                <div className="text-sm text-gray-600 mb-1">Success Rate</div>
                <div className="text-2xl font-bold text-gray-900">98%</div>
                <div className="text-xs text-green-600 mt-1">+2% vs last month</div>
              </div>
              <div className="bg-white rounded-lg p-4 border border-gray-200">
                <div className="text-sm text-gray-600 mb-1">Total Executions</div>
                <div className="text-2xl font-bold text-gray-900">1,225</div>
                <div className="text-xs text-gray-600 mt-1">Last 30 days</div>
              </div>
            </div>
          </div>

          {/* Error Analysis */}
          <div>
            <h3 className="text-lg font-bold text-gray-900 mb-4">Error Analysis</h3>
            <div className="bg-gray-50 rounded-lg p-4 border border-gray-200">
              <div className="flex items-start gap-3 mb-3">
                <div className="text-sm text-gray-900 font-medium">Most Common Errors (Last 30 Days)</div>
              </div>
              <div className="space-y-2 text-sm">
                <div className="flex items-center justify-between">
                  <div className="text-gray-700">Invalid email address</div>
                  <div className="text-gray-600">8 occurrences</div>
                </div>
                <div className="flex items-center justify-between">
                  <div className="text-gray-700">API rate limit exceeded</div>
                  <div className="text-gray-600">3 occurrences</div>
                </div>
                <div className="flex items-center justify-between">
                  <div className="text-gray-700">Missing required field</div>
                  <div className="text-gray-600">2 occurrences</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    }

    function TemplateCard({ template, onClick }) {
      return (
        <div
          onClick={onClick}
          className="bg-white rounded-lg border border-gray-200 p-6 hover:shadow-lg hover:border-blue-300 transition-all cursor-pointer"
        >
          <div className="flex items-start justify-between mb-4">
            <div className="text-4xl">{template.icon}</div>
            <div className="flex gap-2 flex-wrap justify-end">
              {template.isInsights && (
                <span className="bg-purple-100 text-purple-800 text-xs font-bold px-2 py-1 rounded flex items-center gap-1">
                  <Brain size={12} />
                  INSIGHTS
                </span>
              )}
              {template.isAdvanced && (
                <span className="bg-purple-100 text-purple-800 text-xs font-bold px-2 py-1 rounded">
                  ADVANCED
                </span>
              )}
              {template.usesLooker && (
                <span className="bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 rounded flex items-center gap-1">
                  üìä LOOKER
                </span>
              )}
            </div>
          </div>
          <h3 className="text-lg font-bold text-gray-900 mb-2">{template.name}</h3>
          <p className="text-sm text-gray-600 mb-4">{template.description}</p>
          <div className="flex items-center justify-between">
            <span className="text-xs text-gray-500">{template.category}</span>
            <div className="flex items-center gap-1">
              <span className="text-xs text-gray-500">{template.popularity}% use this</span>
            </div>
          </div>
        </div>
      );
    }

    // Render the app
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<AutomationCenterDemo />);

  </script>
</body>

</html>